<!DOCTYPE html><HTML class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="ie=edge" http-equiv="x-ua-compatible"/><meta content="A Julia software library for the exploration of chaos and nonlinear dynamics." name="description"/><meta content="George Datseris" name="author"/><meta content="Copy to clipboard" name="lang:clipboard.copy"/><meta content="Copied to clipboard" name="lang:clipboard.copied"/><meta content="en" name="lang:search.language"/><meta content="True" name="lang:search.pipeline.stopwords"/><meta content="True" name="lang:search.pipeline.trimmer"/><meta content="No matching documents" name="lang:search.result.none"/><meta content="1 matching document" name="lang:search.result.one"/><meta content="# matching documents" name="lang:search.result.other"/><meta content="[\s\-]+" name="lang:search.tokenizer"/><link href="../../assets/images/favicon.png" rel="shortcut icon"/><meta content="mkdocs-0.17.5, mkdocs-material-2.9.4" name="generator"/><title>Estimating Delay Embedding Parameters - DynamicalSystems.jl</title><link href="../../assets/stylesheets/application.451f80e5.css" rel="stylesheet"/><link href="../../assets/stylesheets/application-palette.22915126.css" rel="stylesheet"/><meta content="#7e57c2" name="theme-color"/><script src="../../assets/javascripts/modernizr.1aa3b519.js"></script><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,400i,700|Source+Code+Pro" rel="stylesheet"/><style>body,input{font-family:"Montserrat","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro","Courier New",Courier,monospace}</style><link href="../../assets/fonts/material-icons.css" rel="stylesheet"/><link href="../../assets\Documenter.css" rel="stylesheet"/><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This documentation is not for the latest version. <br> <a href="' + href + '">Go to the latest documentation</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body data-md-color-accent="teal" data-md-color-primary="deep-purple" dir="ltr"><svg class="md-svg"><defs><svg height="448" id="__github" viewBox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" fill="currentColor"></path></svg></defs></svg><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a class="md-skip" href="#estimating-delay-embedding-parameters" tabindex="1">
        Skip to content
      </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a class="md-header-nav__button md-logo" href="../.." title="DynamicalSystems.jl"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">
                DynamicalSystems.jl
              </span><span class="md-header-nav__topic">
                Estimating Delay Embedding Parameters
              </span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/><label class="md-icon md-search__icon" for="__search"></label><button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix=""><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">
            Type to start searching
          </div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a class="md-source" data-md-source="github" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository"><div class="md-source__icon"><svg height="24" viewBox="0 0 24 24" width="24"><use height="24" href="#__github" width="24"></use></svg></div><div class="md-source__repository">
      GitHub
    </div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a class="md-nav__button md-logo" href="../.." title="DynamicalSystems.jl"><i class="md-icon"></i></a>
    DynamicalSystems.jl
  </label><div class="md-nav__source"><a class="md-source" data-md-source="github" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository"><div class="md-source__icon"><svg height="24" viewBox="0 0 24 24" width="24"><use height="24" href="#__github" width="24"></use></svg></div><div class="md-source__repository">
      GitHub
    </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../.." title="Introduction &amp; Contents">
      Introduction &amp; Contents
    </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/><label class="md-nav__link" for="nav-2">
      DynamicalSystemsBase
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">
        DynamicalSystemsBase
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../ds/general/" title="Dynamical System Definition">
      Dynamical System Definition
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../ds/evolve/" title="Time Evolution">
      Time Evolution
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../ds/predefined/" title="Predefined Systems">
      Predefined Systems
    </a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/><label class="md-nav__link" for="nav-3">
      DelayEmbeddings
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">
        DelayEmbeddings
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../dataset/" title="Numerical Data">
      Numerical Data
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../reconstruction/" title="Delay Coordinates">
      Delay Coordinates
    </a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc">
        Estimating Delay Embedding Parameters
      </label><a class="md-nav__link md-nav__link--active" href="./" title="Estimating Delay Embedding Parameters">
      Estimating Delay Embedding Parameters
    </a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#delay-time" title="Delay Time">
    Delay Time
  </a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#mutual-information" title="Mutual Information">
    Mutual Information
  </a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#embedding-dimension" title="Embedding Dimension">
    Embedding Dimension
  </a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#example" title="Example">
    Example
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#functions" title="Functions">
    Functions
  </a></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/><label class="md-nav__link" for="nav-4">
      ChaosTools
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">
        ChaosTools
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/overview/" title="Features Overview">
      Features Overview
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/orbitdiagram/" title="Orbit Diagrams &amp; PSOS">
      Orbit Diagrams &amp; PSOS
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/lyapunovs/" title="Lyapunov Exponents">
      Lyapunov Exponents
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/chaos_detection/" title="Chaos Detection">
      Chaos Detection
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/entropies/" title="Entropies and Dimensions">
      Entropies and Dimensions
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/nlts/" title="Nonlinear Timeseries Analysis">
      Nonlinear Timeseries Analysis
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/periodicity/" title="Periodicity">
      Periodicity
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/choosing/" title="Choosing a solver">
      Choosing a solver
    </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/><label class="md-nav__link" for="nav-5">
      RecurrenceAnalysis
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">
        RecurrenceAnalysis
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../rqa/rplots/" title="Recurrence Plots">
      Recurrence Plots
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../rqa/quantification/" title="Quantification &amp; Analysis functions">
      Quantification &amp; Analysis functions
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../rqa/windowed/" title="Windowed RQA">
      Windowed RQA
    </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" id="nav-6" type="checkbox"/><label class="md-nav__link" for="nav-6">
      InteractiveChaos
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">
        InteractiveChaos
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../interact/od/" title="Orbit Diagram">
      Orbit Diagram
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../interact/psos/" title="Poincaré Surface of Section">
      Poincaré Surface of Section
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../interact/highlight/" title="Trajectory Highlighter">
      Trajectory Highlighter
    </a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../../advanced/" title="Advanced Documentation">
      Advanced Documentation
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../contributors_guide/" title="Contributor Guide">
      Contributor Guide
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../news/" title="News">
      News
    </a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#delay-time" title="Delay Time">
    Delay Time
  </a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#mutual-information" title="Mutual Information">
    Mutual Information
  </a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#embedding-dimension" title="Embedding Dimension">
    Embedding Dimension
  </a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#example" title="Example">
    Example
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#functions" title="Functions">
    Functions
  </a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a class="md-icon md-content__icon" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/edit/master/docs/embedding/estimate.md" title="Edit this page"></a><p><a id="Estimating-Delay-Embedding-Parameters-1"></a></p><h1 id="estimating-delay-embedding-parameters">Estimating Delay Embedding Parameters</h1><p>The following functions can estimate good values that can be used in <a href="../reconstruction/#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> for either the delay time or the number of temporal neighbors.</p><p><a id="Delay-Time-1"></a></p><h2 id="delay-time">Delay Time</h2><p><a href="#DelayEmbeddings.estimate_delay" id="DelayEmbeddings.estimate_delay">#</a><strong><code>DelayEmbeddings.estimate_delay</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">estimate_delay</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">method</span><span class="o">::</span><span class="n">String</span> <span class="p">[,</span> <span class="n">τs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">100</span><span class="p">];</span> <span class="n">kwargs</span><span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">τ</span>
</pre></div><p>Estimate an optimal delay to be used in <a href="../reconstruction/#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> or <a href="../reconstruction/#DelayEmbeddings.embed"><code>embed</code></a>. The <code>method</code> can be one of the following:</p><ul><li><code>"ac_zero"</code> : first delay at which the auto-correlation function becomes &lt;0.</li><li><code>"ac_min"</code> : delay of first minimum of the auto-correlation function.</li><li><code>"mi_min"</code> : delay of first minimum of mutual information of <code>s</code> with itself (shifted for various <code>τs</code>). Keywords <code>nbins, binwidth</code> are propagated into <a href="./#DelayEmbeddings.mutualinformation"><code>mutualinformation</code></a>.</li><li><code>"exp_decay"</code> : <a href="./#DelayEmbeddings.exponential_decay_fit"><code>exponential_decay_fit</code></a> of the correlation function rounded  to an integer (uses least squares on <code>c(t) = exp(-t/τ)</code> to find <code>τ</code>).</li><li><code>"exp_extrema"</code> : same as above but the exponential fit is done to the absolute value of the local extrema of the correlation function.</li></ul><p>Both the mutual information and correlation function (<code>autocor</code>) are computed <em>only</em> for delays <code>τs</code>. This means that the <code>min</code> methods can never return the first value of <code>τs</code>!</p><p>The method <code>mi_min</code> is significantly more accurate than the others and also returns good results for most timeseries. It is however the slowest method (but still quite fast!).</p><p><a href="#DelayEmbeddings.exponential_decay_fit" id="DelayEmbeddings.exponential_decay_fit">#</a><strong><code>DelayEmbeddings.exponential_decay_fit</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">exponential_decay_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="o">:</span><span class="n">equal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">τ</span>
</pre></div><p>Perform a least square fit of the form <code>y = exp(-x/τ)</code> and return <code>τ</code>. Taken from:  http://mathworld.wolfram.com/LeastSquaresFittingExponential.html. Assumes equal lengths of <code>x, y</code> and that <code>y ≥ 0</code>.</p><p>To use the method that gives more weight to small values of <code>y</code>, use <code>weight = :small</code>.</p><p><a id="Mutual-Information-1"></a></p><h3 id="mutual-information">Mutual Information</h3><p><a href="#DelayEmbeddings.mutualinformation" id="DelayEmbeddings.mutualinformation">#</a><strong><code>DelayEmbeddings.mutualinformation</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">mutualinformation</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">τs</span><span class="p">[;</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">binwidth</span><span class="p">])</span>
</pre></div><p>Calculate the mutual information between the time series <code>s</code> and its images delayed by <code>τ</code> points for <code>τ</code> ∈ <code>τs</code>, using an <em>improvement</em> of the method outlined by Fraser &amp; Swinney in [1].</p><p><strong>Description</strong></p><p>The joint space of <code>s</code> and its <code>τ</code>-delayed image (<code>sτ</code>) is partitioned as a rectangular grid, and the mutual information is computed from the joint and marginal frequencies of <code>s</code> and <code>sτ</code> in the grid as defined in [1]. The mutual information values are returned in a vector of the same length as <code>τs</code>.</p><p>If any of the optional keyword parameters is given, the grid will be a homogeneous partition of the space where <code>s</code> and <code>sτ</code> are defined. The margins of that partition will be divided in a number of bins equal to <code>nbins</code>, such that the width of each bin will be <code>binwidth</code>, and the range of nonzero values of <code>s</code> will be in the centre. If only of those two parameters is given, the other will be automatically calculated to adjust the size of the grid to the area where <code>s</code> and <code>sτ</code> are nonzero.</p><p>If no parameter is given, the space will be partitioned by a recursive bisection algorithm based on the method given in [1].</p><p>Notice that the recursive method of [1] evaluates the joint frequencies of <code>s</code> and <code>sτ</code> in each cell resulting from a partition, and stops when the data points are uniformly distributed across the sub-partitions of the following levels. For performance and stability reasons, the automatic partition method implemented in this function is only used to divide the axes of the grid, using the marginal frequencies of <code>s</code>.</p><p><strong>References</strong></p><p>[1]: Fraser A.M. &amp; Swinney H.L. "Independent coordinates for strange attractors from mutual information" <em>Phys. Rev. A 33</em>(2), 1986, 1134:1140.</p><hr/><p>Besides the above method, there also exists code that computes mutual information in two other ways. Both ways are in the file <code>DelayEmbedding\src\old_mutual_info.jl</code>. The first way is the original algorithm of Fraser, while the second is the algorithm of Kraskov. Both of these implementations are inferior to the one exposed here (performance-wise).</p><p><a id="Embedding-Dimension-1"></a></p><h2 id="embedding-dimension">Embedding Dimension</h2><p><a href="#DelayEmbeddings.estimate_dimension" id="DelayEmbeddings.estimate_dimension">#</a><strong><code>DelayEmbeddings.estimate_dimension</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">estimate_dimension</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">,</span> <span class="n">τ</span><span class="o">::</span><span class="kt">Int</span><span class="p">,</span> <span class="n">γs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">"afnn"</span><span class="p">;</span> <span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
</pre></div><p>Compute a quantity that can estimate an optimal amount of temporal neighbors <code>γ</code> to be used in <a href="../reconstruction/#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> or <a href="../reconstruction/#DelayEmbeddings.embed"><code>embed</code></a>.</p><p><strong>Description</strong></p><p>Given the scalar timeseries <code>s</code> and the embedding delay <code>τ</code> compute a quantity for each <code>γ ∈ γs</code> based on the "nearest neighbors" in the embedded time series.</p><p>The quantity that is calculated depends on the algorithm defined by the string <code>method</code>:</p><ul><li><code>"afnn"</code> (default) is Cao's "Averaged False Nearest Neighbors" method [1], which   gives a ratio of distances between nearest neighbors. This ratio saturates   around <code>1.0</code> near the optimal value of <code>γ</code> (see <a href="./#DelayEmbeddings.afnn"><code>afnn</code></a>).</li><li><code>"fnn"</code> is Kennel's "False Nearest Neighbors" method [2], which gives the   number of points that cease to be "nearest neighbors" when the dimension   increases. This number drops down to zero near the optimal value of <code>γ</code>.   This method accepts the keyword arguments <code>rtol</code> and <code>atol</code>, which stand   for the "tolerances" required by Kennel's algorithm (see <a href="./#DelayEmbeddings.fnn"><code>fnn</code></a>).</li><li><code>"f1nn"</code> is Krakovská's "False First Nearest Neighbors" method [3], which   gives the ratio of pairs of points that cease to be "nearest neighbors"   when the dimension increases. This number drops down to zero near the   optimal value of <code>γ</code> (see <a href="./#DelayEmbeddings.f1nn"><code>f1nn</code></a>).</li></ul><p><code>"afnn"</code> and <code>"f1nn"</code> also support the <code>metric</code> keyword, which can be any of <code>Cityblock(), Euclidean(), Chebyshev()</code>. This metric is used both for computing the nearest neighbors (<code>KDTree</code>s) as well as the distances necessary for Cao's method (eqs. (2, 3) of [1]). Defaults to <code>Euclidean()</code> (note that [1] used <code>Chebyshev</code>).</p><p>Please be aware that in <strong>DynamicalSystems.jl</strong><code>γ</code> stands for the amount of temporal neighbors and not the embedding dimension (<code>D = γ + 1</code>, see also <a href="../reconstruction/#DelayEmbeddings.embed"><code>embed</code></a>).</p><p><strong>References</strong></p><p>[1] : Liangyue Cao, <a href="https://www.sciencedirect.com/science/article/pii/S0167278997001188?via%3Dihub">Physica D, pp. 43-50 (1997)</a></p><p>[2] : M. Kennel <em>et al.</em>, <a href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.45.3403">Phys. Review A <strong>45</strong>(6), 3403-3411</a> (1992).</p><p>[3] : Anna Krakovská <em>et al.</em>, <a href="https://doi.org/10.1155/2015/932750">J. Complex Sys. 932750 (2015)</a></p><p><a id="Example-1"></a></p><h3 id="example">Example</h3><div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">DynamicalSystems</span><span class="p">,</span> <span class="n">PyPlot</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">roessler</span><span class="p">()</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">τ</span> <span class="o">=</span> <span class="n">estimate_delay</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"mi_min"</span><span class="p">)</span> <span class="c"># first minimum of mutual information</span>

<span class="n">figure</span><span class="p">();</span>
<span class="k">for</span> <span class="n">method</span> <span class="kp">in</span> <span class="p">[</span><span class="s">"afnn"</span><span class="p">,</span> <span class="s">"fnn"</span><span class="p">,</span> <span class="s">"f1nn"</span><span class="p">]</span>
    <span class="n">Ds</span> <span class="o">=</span> <span class="n">estimate_dimension</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">τ</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span> <span class="n">Ds</span> <span class="o">./</span> <span class="n">maximum</span><span class="p">(</span><span class="n">Ds</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="n">method</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">"o"</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">legend</span><span class="p">();</span> <span class="n">xlabel</span><span class="p">(</span><span class="s">"</span><span class="se">\$\\</span><span class="s">gamma</span><span class="se">\$</span><span class="s"> (temporal neighbors)"</span><span class="p">)</span>
<span class="n">tight_layout</span><span class="p">()</span>
</pre></div><p><img alt="" src="../estimateD.png"/></p><p><a id="Functions-1"></a></p><h3 id="functions">Functions</h3><p><a href="#DelayEmbeddings.fnn" id="DelayEmbeddings.fnn">#</a><strong><code>DelayEmbeddings.fnn</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">fnn</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">,</span> <span class="n">τ</span><span class="o">:</span><span class="kt">Int</span><span class="p">,</span> <span class="n">γs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="p">;</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div><p>Calculate the number of "false nearest neighbors" (FNN) of the datasets created from <code>s</code> with a sequence of <code>τ</code>-delayed temporal neighbors.</p><p><strong>Description</strong></p><p>Given a dataset made by embedding <code>s</code> with <code>γ</code> temporal neighbors and delay <code>τ</code>, the "false nearest neighbors" (FNN) are the pairs of points that are nearest to each other at dimension <code>γ</code>, but are separated at dimension <code>γ+1</code>. Kennel's criteria for detecting FNN are based on a threshold for the relative increment of the distance between the nearest neighbors (<code>rtol</code>, eq. 4 in [1]), and another threshold for the ratio between the increased distance and the "size of the attractor" (<code>atol</code>, eq. 5 in [1]). These thresholds are given as keyword arguments.</p><p>The returned value is a vector with the number of FNN for each <code>γ ∈ γs</code>. The optimal value for <code>γ</code> is found at the point where the number of FNN approaches zero.</p><p>See also: <a href="./#DelayEmbeddings.estimate_dimension"><code>estimate_dimension</code></a>, <a href="./#DelayEmbeddings.afnn"><code>afnn</code></a>, <a href="./#DelayEmbeddings.f1nn"><code>f1nn</code></a>.</p><p><strong>References</strong></p><p>[1] : M. Kennel <em>et al.</em>, "Determining embedding dimension for phase-space reconstruction using a geometrical construction", <em>Phys. Review A 45</em>(6), 3403-3411 (1992).</p><p><a href="#DelayEmbeddings.afnn" id="DelayEmbeddings.afnn">#</a><strong><code>DelayEmbeddings.afnn</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">afnn</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">,</span> <span class="n">τ</span><span class="o">:</span><span class="kt">Int</span><span class="p">,</span> <span class="n">γs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">Euclidean</span><span class="p">())</span>
</pre></div><p>Compute the parameter E₁ of Cao's "averaged false nearest neighbors" method for determining the minimum embedding dimension of the time series <code>s</code>, with a sequence of <code>τ</code>-delayed temporal neighbors [1].</p><p><strong>Description</strong></p><p>Given the scalar timeseries <code>s</code> and the embedding delay <code>τ</code> compute the values of <code>E₁</code> for each <code>γ ∈ γs</code>, according to Cao's Method (eq. 3 of [1]).</p><p>This quantity is a ratio of the averaged distances between the nearest neighbors of the reconstructed time series, which quantifies the increment of those distances when the number of temporal neighbors changes from <code>γ</code> to <code>γ+1</code>.</p><p>Return the vector of all computed <code>E₁</code>s. To estimate a good value for <code>γ</code> from this, find <code>γ</code> for which the value <code>E₁</code> saturates at some value around 1.</p><p><em>Note: This method does not work for datasets with perfectly periodic signals.</em></p><p>See also: <a href="./#DelayEmbeddings.estimate_dimension"><code>estimate_dimension</code></a>, <a href="./#DelayEmbeddings.fnn"><code>fnn</code></a>, <a href="./#DelayEmbeddings.f1nn"><code>f1nn</code></a>.</p><p><strong>References</strong></p><p>[1] : Liangyue Cao, <a href="https://www.sciencedirect.com/science/article/pii/S0167278997001188?via%3Dihub">Physica D, pp. 43-50 (1997)</a></p><p><a href="#DelayEmbeddings.f1nn" id="DelayEmbeddings.f1nn">#</a><strong><code>DelayEmbeddings.f1nn</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">f1nn</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">,</span> <span class="n">τ</span><span class="o">:</span><span class="kt">Int</span><span class="p">,</span> <span class="n">γs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="n">Euclidean</span><span class="p">())</span>
</pre></div><p>Calculate the ratio of "false first nearest neighbors" (FFNN) of the datasets created from <code>s</code> with a sequence of <code>τ</code>-delayed temporal neighbors.</p><p><strong>Description</strong></p><p>Given a dataset made by embedding <code>s</code> with <code>γ</code> temporal neighbors and delay <code>τ</code>, the "first nearest neighbors" (FFNN) are the pairs of points that are nearest to each other at dimension <code>γ</code> that cease to be nearest neighbors at dimension <code>γ+1</code> [1].</p><p>The returned value is a vector with the ratio between the number of FFNN and the number of points in the dataset for each <code>γ ∈ γs</code>. The optimal value for <code>γ</code> is found at the point where this ratio approaches zero.</p><p>See also: <a href="./#DelayEmbeddings.estimate_dimension"><code>estimate_dimension</code></a>, <a href="./#DelayEmbeddings.afnn"><code>afnn</code></a>, <a href="./#DelayEmbeddings.fnn"><code>fnn</code></a>.</p><p><strong>References</strong></p><p>[1] : Anna Krakovská <em>et al.</em>, "Use of false nearest neighbours for selecting variables and embedding parameters for state space reconstruction", <em>J Complex Sys</em> 932750 (2015), DOI: 10.1155/2015/932750</p><p><a href="#DelayEmbeddings.stochastic_indicator" id="DelayEmbeddings.stochastic_indicator">#</a><strong><code>DelayEmbeddings.stochastic_indicator</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span><span class="n">stochastic_indicator</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">,</span> <span class="n">τ</span><span class="o">:</span><span class="kt">Int</span><span class="p">,</span> <span class="n">γs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">E₂s</span>
</pre></div><p>Compute an estimator for apparent randomness in a reconstruction with <code>γs</code> temporal neighbors.</p><p><strong>Description</strong></p><p>Given the scalar timeseries <code>s</code> and the embedding delay <code>τ</code> compute the values of <code>E₂</code> for each <code>γ ∈ γs</code>, according to Cao's Method (eq. 5 of [1]).</p><p>Use this function to confirm that the input signal is not random and validate the results of <a href="./#DelayEmbeddings.estimate_dimension"><code>estimate_dimension</code></a>. In the case of random signals, it should be <code>E₂ ≈ 1 ∀ γ</code>.</p><p><strong>References</strong></p><p>[1] : Liangyue Cao, <a href="https://www.sciencedirect.com/science/article/pii/S0167278997001188?via%3Dihub">Physica D, pp. 43-50 (1997)</a></p><hr/></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../reconstruction/" rel="prev" title="Delay Coordinates"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">
                  Previous
                </span>
                Delay Coordinates
              </span></div></a><a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../../chaos/overview/" rel="next" title="Features Overview"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">
                  Next
                </span>
                Features Overview
              </span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a></div><div class="md-footer-social"><link href="../../assets/fonts/font-awesome.css" rel="stylesheet"/><a class="md-footer-social__link fa fa-github" href="https://github.com/JuliaDynamics/DynamicalSystems.jl"></a></div></div></div></footer></div><script src="../../assets/javascripts/application.30f6b8b1.js"></script><script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script><script src="../../assets\mathjaxhelper.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></HTML>