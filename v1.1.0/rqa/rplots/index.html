<!DOCTYPE html><HTML class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="ie=edge" http-equiv="x-ua-compatible"/><meta content="A Julia software library for the exploration of chaos and nonlinear dynamics." name="description"/><meta content="George Datseris" name="author"/><meta content="Copy to clipboard" name="lang:clipboard.copy"/><meta content="Copied to clipboard" name="lang:clipboard.copied"/><meta content="en" name="lang:search.language"/><meta content="True" name="lang:search.pipeline.stopwords"/><meta content="True" name="lang:search.pipeline.trimmer"/><meta content="No matching documents" name="lang:search.result.none"/><meta content="1 matching document" name="lang:search.result.one"/><meta content="# matching documents" name="lang:search.result.other"/><meta content="[\s\-]+" name="lang:search.tokenizer"/><link href="../../assets/images/favicon.png" rel="shortcut icon"/><meta content="mkdocs-0.17.5, mkdocs-material-2.9.4" name="generator"/><title>Recurrence Plots - DynamicalSystems.jl</title><link href="../../assets/stylesheets/application.451f80e5.css" rel="stylesheet"/><link href="../../assets/stylesheets/application-palette.22915126.css" rel="stylesheet"/><meta content="#7e57c2" name="theme-color"/><script src="../../assets/javascripts/modernizr.1aa3b519.js"></script><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono" rel="stylesheet"/><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link href="../../assets/fonts/material-icons.css" rel="stylesheet"/><link href="../../assets\Documenter.css" rel="stylesheet"/><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This documentation is not for the latest version. <br> <a href="' + href + '">Go to the latest documentation</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body data-md-color-accent="teal" data-md-color-primary="deep-purple" dir="ltr"><svg class="md-svg"><defs><svg height="448" id="__github" viewBox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" fill="currentColor"></path></svg></defs></svg><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a class="md-skip" href="#recurrence-plots" tabindex="1">
        Skip to content
      </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a class="md-header-nav__button md-logo" href="../.." title="DynamicalSystems.jl"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">
                DynamicalSystems.jl
              </span><span class="md-header-nav__topic">
                Recurrence Plots
              </span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/><label class="md-icon md-search__icon" for="__search"></label><button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix=""><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">
            Type to start searching
          </div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a class="md-source" data-md-source="github" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository"><div class="md-source__icon"><svg height="24" viewBox="0 0 24 24" width="24"><use height="24" href="#__github" width="24"></use></svg></div><div class="md-source__repository">
      GitHub
    </div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a class="md-nav__button md-logo" href="../.." title="DynamicalSystems.jl"><i class="md-icon"></i></a>
    DynamicalSystems.jl
  </label><div class="md-nav__source"><a class="md-source" data-md-source="github" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository"><div class="md-source__icon"><svg height="24" viewBox="0 0 24 24" width="24"><use height="24" href="#__github" width="24"></use></svg></div><div class="md-source__repository">
      GitHub
    </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../.." title="Introduction">
      Introduction
    </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/><label class="md-nav__link" for="nav-2">
      Dynamical Systems
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">
        Dynamical Systems
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../ds/general/" title="Dynamical System Definition">
      Dynamical System Definition
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../ds/evolve/" title="Time Evolution">
      Time Evolution
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../ds/predefined/" title="Predefined Systems">
      Predefined Systems
    </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/><label class="md-nav__link" for="nav-3">
      ChaosTools
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">
        ChaosTools
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/overview/" title="Features Overview">
      Features Overview
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/orbitdiagram/" title="Orbit Diagrams &amp; PSOS">
      Orbit Diagrams &amp; PSOS
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/lyapunovs/" title="Lyapunov Exponents">
      Lyapunov Exponents
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/entropies/" title="Entropies and Dimensions">
      Entropies and Dimensions
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/nlts/" title="Nonlinear Timeseries Analysis">
      Nonlinear Timeseries Analysis
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/periodicity/" title="Periodicity">
      Periodicity
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../chaos/chaos_detection/" title="Chaos Distinction">
      Chaos Distinction
    </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/><label class="md-nav__link" for="nav-4">
      Delay Coordinates Embedding
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">
        Delay Coordinates Embedding
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../embedding/dataset/" title="Numerical Data">
      Numerical Data
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../embedding/reconstruction/" title="Delay Coordinates">
      Delay Coordinates
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../embedding/estimate/" title="Estimating Delay Embedding Parameters">
      Estimating Delay Embedding Parameters
    </a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/><label class="md-nav__link" for="nav-5">
      Recurrence Quantification Analysis
    </label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">
        Recurrence Quantification Analysis
      </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc">
        Recurrence Plots
      </label><a class="md-nav__link md-nav__link--active" href="./" title="Recurrence Plots">
      Recurrence Plots
    </a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#recurrence-matrices" title="Recurrence Matrices">
    Recurrence Matrices
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#plottable-format" title="Plottable Format">
    Plottable Format
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#example" title="Example">
    Example
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#distances" title="Distances">
    Distances
  </a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../quantification/" title="Quantification &amp; Analysis functions">
      Quantification &amp; Analysis functions
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../windowed/" title="Windowed RQA">
      Windowed RQA
    </a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../../advanced/" title="Advanced Documentation">
      Advanced Documentation
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../contributors_guide/" title="Contributor Guide">
      Contributor Guide
    </a></li><li class="md-nav__item"><a class="md-nav__link" href="../../news/" title="News">
      News
    </a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#recurrence-matrices" title="Recurrence Matrices">
    Recurrence Matrices
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#plottable-format" title="Plottable Format">
    Plottable Format
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#example" title="Example">
    Example
  </a></li><li class="md-nav__item"><a class="md-nav__link" href="#distances" title="Distances">
    Distances
  </a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a class="md-icon md-content__icon" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/edit/master/docs/rqa/rplots.md" title="Edit this page"></a><p><a id="Recurrence-Plots-1"></a></p><h1 id="recurrence-plots">Recurrence Plots</h1><p><a id="Recurrence-Matrices-1"></a></p><h2 id="recurrence-matrices">Recurrence Matrices</h2><p>A <a href="https://en.wikipedia.org/wiki/Recurrence_plot">Recurrence plot</a> (which refers to the plot of a matrix) is a way to quantify <em>recurrences</em> that occur in a trajectory. A recurrence happens when a trajectory visits the same neighborhood on the phase space that it was at some previous time.</p><p>The central structure used in these recurrences is the (cross-) recurrence matrix:</p><div><div class="MathJax_Preview">
R(i, j) = \begin{cases}
1 \quad \text{if}\quad d(x[i], y[j]) \le \varepsilon\\
0 \quad \text{else}
\end{cases}
</div><script type="math/tex; mode=display">
R(i, j) = \begin{cases}
1 \quad \text{if}\quad d(x[i], y[j]) \le \varepsilon\\
0 \quad \text{else}
\end{cases}
</script></div><p>where <span><span class="MathJax_Preview">d(x[i], y[j])</span><script type="math/tex">d(x[i], y[j])</script></span> stands for the <em>distance</em> between trajectory <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> at point <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span> and trajectory <span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> at point <span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>. If <span><span class="MathJax_Preview">x\equiv y</span><script type="math/tex">x\equiv y</script></span> then <span><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> is called recurrence matrix, otherwise it is called cross-recurrence matrix. There is also the joint-recurrence variant, see below.</p><p>With <code>RecurrenceAnalysis</code> you can use the following functions to access these matrices</p><p><a href="#RecurrenceAnalysis.recurrencematrix" id="RecurrenceAnalysis.recurrencematrix">#</a><strong><code>RecurrenceAnalysis.recurrencematrix</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span>recurrencematrix(x, ε; kwargs...)
</pre></div><p>Create a recurrence matrix from an embedded time series.</p><p><strong>Description</strong></p><p>The recurrence matrix is a numeric representation of a "recurrence plot" [1, 2], in the form of a sparse square matrix of Boolean values.</p><p><code>x</code> must be <code>Dataset</code> or a Vector or Matrix with data points in rows (possibly representing and embedded phase, space; see <a href="../../embedding/reconstruction/#DelayEmbeddings.embed"><code>embed</code></a>). If <code>d(x[i], x[j]) ≤ ε</code> (with <code>d</code> the distance function), then the cell <code>(i, j)</code> of the matrix will have a <code>true</code> value. The criteria to evaluate distances between data points are defined by the following keyword arguments:</p><ul><li><code>scale</code> : a function of the distance matrix (see <a href="./#RecurrenceAnalysis.distancematrix"><code>distancematrix</code></a>), or a fixed number, used to scale the value of <code>ε</code>. Typical choices are <code>maximum</code> or <code>mean</code>, such that the threshold <code>ε</code> is defined as a ratio of the maximum or the mean distance between data points, respectively. Use <code>1</code> to keep the distances unscaled (default).</li><li><code>fixedrate::Bool=false</code> : a flag that indicates if <code>ε</code> should be taken as a target fixed recurrence rate (see <a href="../quantification/#RecurrenceAnalysis.recurrencerate"><code>recurrencerate</code></a>). If <code>fixedrate</code> is set to <code>true</code>, <code>ε</code> must be a value between 0 and 1, and <code>scale</code> is ignored.</li><li><code>metric</code> : metric of the distances, as in <a href="./#RecurrenceAnalysis.distancematrix"><code>distancematrix</code></a>.</li></ul><p>See also: <a href="./#RecurrenceAnalysis.crossrecurrencematrix"><code>crossrecurrencematrix</code></a>, <a href="./#RecurrenceAnalysis.jointrecurrencematrix"><code>jointrecurrencematrix</code></a> and use <a href="./#RecurrenceAnalysis.recurrenceplot"><code>recurrenceplot</code></a> to turn the result of these functions into a plottable format.</p><p><strong>References</strong></p><p>[1] : N. Marwan <em>et al.</em>, "Recurrence plots for the analysis of complex systems", <em>Phys. Reports 438</em>(5-6), 237-329 (2007).</p><p>[2] : N. Marwan &amp; C.L. Webber, "Mathematical and computational foundations of recurrence quantifications", in: Webber, C.L. &amp; N. Marwan (eds.), <em>Recurrence Quantification Analysis. Theory and Best Practices</em>, Springer, pp. 3-43 (2015).</p><p><a href="#RecurrenceAnalysis.crossrecurrencematrix" id="RecurrenceAnalysis.crossrecurrencematrix">#</a><strong><code>RecurrenceAnalysis.crossrecurrencematrix</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span>crossrecurrencematrix(x, y, ε; kwargs...)
</pre></div><p>Create a cross recurrence matrix from the time series <code>x</code> and <code>y</code>.</p><p>The cross recurrence matrix is a bivariate extension of the recurrence matrix. For the time series <code>x</code>, <code>y</code>, of length <code>n</code> and <code>m</code>, respectively, it is a sparse <code>n×m</code> matrix of Boolean values, such that if <code>∥x[i] – y[j]∥ ≤ ε</code>, then the cell <code>(i, j)</code> of the matrix will have a <code>true</code> value.</p><p>See <a href="./#RecurrenceAnalysis.recurrencematrix"><code>recurrencematrix</code></a> for details, references and keywords. See also: <a href="./#RecurrenceAnalysis.jointrecurrencematrix"><code>jointrecurrencematrix</code></a>.</p><p><a href="#RecurrenceAnalysis.jointrecurrencematrix" id="RecurrenceAnalysis.jointrecurrencematrix">#</a><strong><code>RecurrenceAnalysis.jointrecurrencematrix</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span>jointrecurrencematrix(x, y, ε; kwargs...)
</pre></div><p>Create a joint recurrence matrix from the time series <code>x</code> and <code>y</code>.</p><p>The joint recurrence matrix considers the recurrences of the trajectories of <code>x</code> and <code>y</code> separately, and looks for points where both recur simultaneously. It is calculated by the element-wise multiplication of the recurrence matrices of <code>x</code> and <code>y</code>. If <code>x</code> and <code>y</code> are of different length, the recurrences are only calculated until the length of the shortest one.</p><p>See <a href="./#RecurrenceAnalysis.recurrencematrix"><code>recurrencematrix</code></a> for details, references and keywords. See also: <a href="./#RecurrenceAnalysis.crossrecurrencematrix"><code>crossrecurrencematrix</code></a>.</p><p><a id="Plottable-Format-1"></a></p><h2 id="plottable-format">Plottable Format</h2><p>As you can tell from the above documentation strings, the recurrence matrices are stored as sparse matrices with boolean values. To create the recurrence plots, one needs to obtain a full form out of them.</p><p>This functionality is supported by the following function:</p><p><a href="#RecurrenceAnalysis.recurrenceplot" id="RecurrenceAnalysis.recurrenceplot">#</a><strong><code>RecurrenceAnalysis.recurrenceplot</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span>recurrenceplot(x [, bwcode]; width::Int, height::Int, exactsize=false)
</pre></div><p>Transform the recurrence matrix <code>x</code> into a full matrix suitable for plotting as a grayscale image. By default it returns a matrix with the same size as <code>x</code>, but switched axes, containing "black" values in the cells that represent recurrent points, and "white" values in the empty cells.</p><p>The numeric codes for black and white are given in a 2-element tuple as a second optional argument. Its default value is <code>(0.0, 1.0)</code>, i.e. black is coded as <code>0.0</code> (no brightness) and white as <code>1.0</code> (full brightness). The type of the elements in the tuple defines the type of the returned matrix. This must be taken into account if, for instance, the image is coded as a matrix of integers corresponding to a grayscale; in such case the black and white codes must be given as numbers of the required integer type.</p><p>The keyword arguments <code>width</code> and <code>height</code> can be given to define a custom size of the image. If only one dimension is given, the other is automatically calculated. If both dimensions are given, by default they are adjusted to keep an aspect proportional to the original matrix, such that the returned matrix fits into a matrix of the given dimensions. This automatic adjustment can be disabled by passing the keyword argument <code>exactsize=true</code>.</p><p>If the image has different dimensions than <code>x</code>, the cells of <code>x</code> are distributed in a grid with the size of the image, and a gray level between white and black is calculated for each element of the grid, proportional to the number of recurrent points contained in it. The levels of gray are coded as numbers of the same type as the black and white codes.</p><p><a id="Example-1"></a></p><h2 id="example">Example</h2><p>Here is a recurrence plot of a full trajectory of the Roessler system:</p><div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">DynamicalSystems</span>
<span class="n">ro</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">roessler</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ro</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="p">,</span> <span class="n">Ttr</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">recurrencematrix</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">;</span> <span class="n">metric</span> <span class="o">=</span> <span class="s">"euclidean"</span><span class="p">)</span>
<span class="n">Rp</span> <span class="o">=</span> <span class="n">recurrenceplot</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div><div class="codehilite"><pre><span></span>2001×2001 Array{Float64,2}:
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     0.0  0.0  0.0  0.0  0.0  0.0  1.0
 ⋮                        ⋮              ⋱       ⋮                        ⋮
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  1.0  1.0  1.0  1.0  1.0  1.0  1.0
</pre></div><div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">PyPlot</span><span class="p">;</span> <span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">dt</span><span class="o">:</span><span class="n">N</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">tr</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s">"k"</span><span class="p">);</span> <span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">dt</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s">"</span><span class="se">\$</span><span class="s">y(t)</span><span class="se">\$</span><span class="s">"</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">Rp</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s">"Greys_r"</span><span class="p">,</span> <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">dt</span><span class="p">))</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">"</span><span class="se">\$</span><span class="s">t</span><span class="se">\$</span><span class="s">"</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s">"</span><span class="se">\$</span><span class="s">t</span><span class="se">\$</span><span class="s">"</span><span class="p">);</span> <span class="n">tight_layout</span><span class="p">()</span>
<span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div><p><img alt="" src="../rmatrix.png"/></p><p><a id="Distances-1"></a></p><h2 id="distances">Distances</h2><p>The distance function used in <a href="./#RecurrenceAnalysis.recurrencematrix"><code>recurrencematrix</code></a> and co. can be specified either as a string or as a <code>Metric</code> instance from <a href="https://github.com/JuliaStats/Distances.jl"><code>Distances</code></a>. In addition, the following function returns a matrix with the cross-distances across all points in one or two trajectories:</p><p><a href="#RecurrenceAnalysis.distancematrix" id="RecurrenceAnalysis.distancematrix">#</a><strong><code>RecurrenceAnalysis.distancematrix</code></strong> — <em>Function</em>.</p><div class="codehilite"><pre><span></span>distancematrix(x [, y = x], metric = Chebyshev())
</pre></div><p>Create a matrix with the distances between each pair of points of the time series <code>x</code> and <code>y</code> using <code>metric</code>.</p><p>The time series <code>x</code> and <code>y</code> can be <code>Dataset</code>s or matrices with data points in rows. The data point dimensions (or number of columns) must be the same for <code>x</code> and <code>y</code>. The returned value is a <code>n×m</code> matrix, with <code>n</code> being the length (or number of rows) of <code>x</code>, and <code>m</code> the length of <code>y</code>.</p><p>The metric can be identified by a string, or any of the <code>Metric</code>s defined in the <a href="https://github.com/JuliaStats/Distances.jl"><code>Distances</code> package</a>. The list of strings available to define the metric are:</p><ul><li><code>"max"</code> or <code>"inf"</code> for the maximum or L∞ norm (<code>Chebyshev()</code> in the <code>Distances</code> package, used by default).</li><li><code>"euclidean"</code> for the L2 or Euclidean norm (<code>Euclidean()</code> in <code>Distances</code>).</li><li><code>"manhattan"</code>, <code>"cityblock"</code>, <code>"taxicab"</code> or <code>"min"</code> for the Manhattan or L1 norm (<code>Cityblock()</code> in <code>Distances</code>).</li></ul></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../../embedding/estimate/" rel="prev" title="Estimating Delay Embedding Parameters"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">
                  Previous
                </span>
                Estimating Delay Embedding Parameters
              </span></div></a><a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../quantification/" rel="next" title="Quantification &amp; Analysis functions"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">
                  Next
                </span>
                Quantification &amp; Analysis functions
              </span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a></div><div class="md-footer-social"><link href="../../assets/fonts/font-awesome.css" rel="stylesheet"/><a class="md-footer-social__link fa fa-github" href="https://github.com/JuliaDynamics/DynamicalSystems.jl"></a></div></div></div></footer></div><script src="../../assets/javascripts/application.30f6b8b1.js"></script><script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script><script src="../../assets\mathjaxhelper.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></HTML>