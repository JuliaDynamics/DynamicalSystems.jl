



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A Julia software library for the exploration of chaos and nonlinear dynamics.">
      
      
      
        <meta name="author" content="George Datseris">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Nonlinear Timeseries Analysis - DynamicalSystems.jl</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../assets\Documenter.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#nonlinear-timeseries-analysis" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="DynamicalSystems.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                DynamicalSystems.jl
              </span>
              <span class="md-header-nav__topic">
                Nonlinear Timeseries Analysis
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    DynamicalSystems.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Fundamentals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Fundamentals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/general/" title="Dynamical Systems" class="md-nav__link">
      Dynamical Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/evolve/" title="Time Evolution" class="md-nav__link">
      Time Evolution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/dataset/" title="Numerical Data" class="md-nav__link">
      Numerical Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/reconstruction/" title="Delay Coordinates" class="md-nav__link">
      Delay Coordinates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/predefined/" title="Predefined Systems" class="md-nav__link">
      Predefined Systems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      ChaosTools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        ChaosTools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../overview/" title="Features Overview" class="md-nav__link">
      Features Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../orbitdiagram/" title="Orbit Diagrams & PSOS" class="md-nav__link">
      Orbit Diagrams & PSOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lyapunovs/" title="Lyapunov Exponents" class="md-nav__link">
      Lyapunov Exponents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../entropies/" title="Entropies and Dimensions" class="md-nav__link">
      Entropies and Dimensions
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Nonlinear Timeseries Analysis
      </label>
    
    <a href="./" title="Nonlinear Timeseries Analysis" class="md-nav__link md-nav__link--active">
      Nonlinear Timeseries Analysis
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#neighborhoods-in-a-dataset" title="Neighborhoods in a Dataset" class="md-nav__link">
    Neighborhoods in a Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerical-lyapunov-exponent" title="Numerical Lyapunov Exponent" class="md-nav__link">
    Numerical Lyapunov Exponent
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-of-numerical-lyapunov-computation" title="Example of Numerical Lyapunov computation" class="md-nav__link">
    Example of Numerical Lyapunov computation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bad-time-axis-ks-length" title="Bad Time-axis (ks) length" class="md-nav__link">
    Bad Time-axis (ks) length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-of-a-continuous-system" title="Case of a Continuous system" class="md-nav__link">
    Case of a Continuous system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broomhead-king-coordinates" title="Broomhead-King Coordinates" class="md-nav__link">
    Broomhead-King Coordinates
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../periodicity/" title="Periodicity" class="md-nav__link">
      Periodicity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../chaos_detection/" title="Chaos Detection" class="md-nav__link">
      Chaos Detection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../advanced/" title="Advanced Documentation" class="md-nav__link">
      Advanced Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributors_guide/" title="Contributor Guide" class="md-nav__link">
      Contributor Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../news/" title="News" class="md-nav__link">
      News
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#neighborhoods-in-a-dataset" title="Neighborhoods in a Dataset" class="md-nav__link">
    Neighborhoods in a Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerical-lyapunov-exponent" title="Numerical Lyapunov Exponent" class="md-nav__link">
    Numerical Lyapunov Exponent
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-of-numerical-lyapunov-computation" title="Example of Numerical Lyapunov computation" class="md-nav__link">
    Example of Numerical Lyapunov computation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bad-time-axis-ks-length" title="Bad Time-axis (ks) length" class="md-nav__link">
    Bad Time-axis (ks) length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-of-a-continuous-system" title="Case of a Continuous system" class="md-nav__link">
    Case of a Continuous system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broomhead-king-coordinates" title="Broomhead-King Coordinates" class="md-nav__link">
    Broomhead-King Coordinates
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/edit/master/docs/chaos/nlts.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='Nonlinear-Timeseries-Analysis-1'></a></p>
<h1 id="nonlinear-timeseries-analysis">Nonlinear Timeseries Analysis</h1>
<p><a id='Neighborhoods-in-a-Dataset-1'></a></p>
<h2 id="neighborhoods-in-a-dataset">Neighborhoods in a Dataset</h2>
<p>Combining the excellent performance of <a href="https://github.com/KristofferC/NearestNeighbors.jl">NearestNeighbors.jl</a> with the <code>AbstractDataset</code> allows us to define a function that calculates a "neighborhood" of a given point, i.e. finds other points near it. The different "types" of the neighborhoods are subtypes of <code>AbstractNeighborhood</code>.</p>
<p><a id='DynamicalSystemsBase.neighborhood' href='#DynamicalSystemsBase.neighborhood'>#</a>
<strong><code>DynamicalSystemsBase.neighborhood</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>neighborhood([n,] point, tree::KDTree, method::AbstractNeighborhood)
</pre></div>


<p>Return a vector of indices which are the neighborhood of <code>point</code>. <code>n</code> is the index of the <code>point</code> in the original dataset. Do not pass any index if the <code>point</code> is not part of the dataset.</p>
<p>If the original dataset is <code>data &lt;: AbstractDataset</code>, then use <code>tree = KDTree(data)</code> to obtain the <code>tree</code> instance (which also contains a copy of the data).</p>
<p>The <code>method</code> can be a subtype of <a href="./#DynamicalSystemsBase.AbstractNeighborhood"><code>AbstractNeighborhood</code></a>.</p>
<p><code>neighborhood</code> works for <em>any</em> subtype of <code>AbstractDataset</code>.</p>
<p><strong>References</strong></p>
<p><code>neighborhood</code> simply interfaces the functions <code>knn</code> and <code>inrange</code> from <a href="https://github.com/KristofferC/NearestNeighbors.jl">NearestNeighbors.jl</a> by using the last argument, <code>method</code>.</p>
<p><a target='_blank' href='https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/29b2ac5d83737d699b5d090978f15cb0c84e56c4/src/neighborhoods.jl#L37-L57' class='documenter-source'>source</a><br></p>
<p><a id='DynamicalSystemsBase.AbstractNeighborhood' href='#DynamicalSystemsBase.AbstractNeighborhood'>#</a>
<strong><code>DynamicalSystemsBase.AbstractNeighborhood</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>AbstractNeighborhood
</pre></div>


<p>Supertype of methods for deciding the neighborhood of points for a given point.</p>
<p>Concrete subtypes:</p>
<ul>
<li><code>FixedMassNeighborhood(K::Int)</code>  : The neighborhood of a point consists of the <code>K</code> nearest neighbors of the point.</li>
<li><code>FixedSizeNeighborhood(ε::Real)</code> : The neighborhood of a point consists of all neighbors that have distance &lt; <code>ε</code> from the point.</li>
</ul>
<p>Notice that these distances are always computed using the Euclidean distance in <code>D</code>-dimensional space.</p>
<p>See also <a href="./#DynamicalSystemsBase.neighborhood"><code>neighborhood</code></a>.</p>
<p><a target='_blank' href='https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/29b2ac5d83737d699b5d090978f15cb0c84e56c4/src/neighborhoods.jl#L12-L26' class='documenter-source'>source</a><br></p>
<hr />
<p><a id='Numerical-Lyapunov-Exponent-1'></a></p>
<h2 id="numerical-lyapunov-exponent">Numerical Lyapunov Exponent</h2>
<p>Given any timeseries, one can first obtain a <a href="../../definition/reconstruction/#DynamicalSystemsBase.Reconstruction"><code>Reconstruction</code></a> from it using delay coordinates, and then calculate a maximum Lyapunov exponent for it. This is done with</p>
<p><a id='ChaosTools.numericallyapunov' href='#ChaosTools.numericallyapunov'>#</a>
<strong><code>ChaosTools.numericallyapunov</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span><span class="n">numericallyapunov</span><span class="p">(</span><span class="n">R</span><span class="o">::</span><span class="n">Reconstruction</span><span class="p">,</span> <span class="n">ks</span><span class="p">;</span>  <span class="n">refstates</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
</pre></div>


<p>Return <code>E = [E(k) for k ∈ ks]</code>, where <code>E(k)</code> is the average logarithmic distance for nearby states that are evolved in time for <code>k</code> steps (<code>k</code> must be integer).</p>
<p><strong>Keyword Arguments</strong></p>
<ul>
<li><code>refstates = 1:(length(R) - ks[end])</code> : Vector of indices that notes which states of the reconstruction should be used as "reference states", which means that the algorithm is applied for all state indices contained in <code>refstates</code>.</li>
<li><code>w::Int = round(Int, mean(R.delay))</code> : The Theiler window, which determines whether points are separated enough in time to be considered separate trajectories (see [1]). Defaults to the mean delay time.</li>
<li><code>method::AbstractNeighborhood = FixedMassNeighborhood(1)</code> : The method to be used when evaluating the neighborhood of each reference state. See <a href="./#DynamicalSystemsBase.AbstractNeighborhood"><code>AbstractNeighborhood</code></a> or <a href="./#DynamicalSystemsBase.neighborhood"><code>neighborhood</code></a> for more info.</li>
<li><code>distance::Metric = Cityblock()</code> : The distance function used in the logarithmic distance of nearby states. The allowed distances are <code>Cityblock()</code> and <code>Euclidean()</code>. See below for more info.</li>
</ul>
<p><strong>Description</strong></p>
<p>If the reconstruction exhibits exponential divergence of nearby states, then it should clearly hold</p>
<div>
<div class="MathJax_Preview">
E(k) \approx \lambda\Delta t k + E(0)
</div>
<script type="math/tex; mode=display">
E(k) \approx \lambda\Delta t k + E(0)
</script>
</div>
<p>for a <em>well defined region</em> in the <code>k</code> axis, where <span><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span> is the approximated maximum Lyapunov exponent. <span><span class="MathJax_Preview">\Delta t</span><script type="math/tex">\Delta t</script></span> is the time between samples in the original timeseries. You can use <a href="../entropies/#ChaosTools.linear_region"><code>linear_region</code></a> with arguments <code>(ks .* Δt, E)</code> to identify the slope (= <span><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>) immediatelly, assuming you have choosen sufficiently good <code>ks</code> such that the linear scaling region is bigger than the saturated region.</p>
<p>The algorithm used in this function is due to Parlitz [1], which itself expands upon Kantz [2]. In sort, for each reference state a neighborhood is evaluated. Then, for each point in this neighborhood, the logarithmic distance between reference state and neighborhood state is calculated as the "time" index <code>k</code> increases. The average of the above over all neighborhood states over all reference states is the returned result.</p>
<p>If the <code>Metric</code> is <code>Euclidean()</code> then use the Euclidean distance of the full <code>D</code>-dimensional points (distance <span><span class="MathJax_Preview">d_E</span><script type="math/tex">d_E</script></span> in ref. [1]). If however the <code>Metric</code> is <code>Cityblock()</code>, calculate the absolute distance of <em>only the first elements</em> of the <code>m+k</code> and <code>n+k</code> points of the reconstruction <code>R</code>(distance <span><span class="MathJax_Preview">d_F</span><script type="math/tex">d_F</script></span> in ref. [1]).</p>
<p><strong>References</strong></p>
<p>[1] : Skokos, C. H. <em>et al.</em>, <em>Chaos Detection and Predictability</em> - Chapter 1 (section 1.3.2), Lecture Notes in Physics <strong>915</strong>, Springer (2016)</p>
<p>[2] : Kantz, H., Phys. Lett. A <strong>185</strong>, pp 77–87 (1994)</p>
<p><a target='_blank' href='https://github.com/JuliaDynamics/ChaosTools.jl/blob/a0b9291018ff89e1407790baea99d060431bb170/src/nlts.jl#L14-L75' class='documenter-source'>source</a><br></p>
<hr />
<p>The function <code>numericallyapunov</code> has a total of 4 different approaches for the algorithmic process, by combining 2 types of distances with 2 types of neighborhoods.</p>
<p><a id='Example-of-Numerical-Lyapunov-computation-1'></a></p>
<h3 id="example-of-numerical-lyapunov-computation">Example of Numerical Lyapunov computation</h3>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">DynamicalSystems</span><span class="p">,</span> <span class="n">PyPlot</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">henon</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c">#fake measurements for the win!</span>

<span class="n">ks</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">20</span>
<span class="n">ℜ</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">10000</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">di</span><span class="p">)</span> <span class="kp">in</span> <span class="n">enumerate</span><span class="p">([</span><span class="n">Euclidean</span><span class="p">(),</span> <span class="n">Cityblock</span><span class="p">()])</span>
  <span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
  <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
  <span class="n">method</span> <span class="o">=</span> <span class="n">FixedMassNeighborhood</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

  <span class="n">title</span><span class="p">(</span><span class="s">&quot;Distance: </span><span class="si">$</span><span class="p">(</span><span class="n">di</span><span class="p">)</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">D</span> <span class="kp">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">Reconstruction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">numericallyapunov</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">ks</span><span class="p">;</span>
    <span class="n">refstates</span> <span class="o">=</span> <span class="n">ℜ</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">di</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="p">)</span>
    <span class="c"># The following operation:</span>
    <span class="n">Δt</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">λ</span> <span class="o">=</span> <span class="n">linear_region</span><span class="p">(</span><span class="n">ks</span><span class="o">.*</span><span class="n">Δt</span><span class="p">,</span> <span class="n">E</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c"># gives the linear slope, i.e. the Lyapunov exponent</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="o">-</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;D=</span><span class="si">$D</span><span class="s">, λ=</span><span class="si">$</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">λ</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">legend</span><span class="p">()</span>
    <span class="n">tight_layout</span><span class="p">()</span>
  <span class="k">end</span>


<span class="k">end</span>
</pre></div>


<p>which gives the result <img alt="Lyapunov exponent of a timeseries" src="https://i.imgur.com/vbKo1vV.png" /></p>
<p><a id='Bad-Time-axis-(ks)-length-1'></a></p>
<h3 id="bad-time-axis-ks-length">Bad Time-axis (<code>ks</code>) length</h3>
<div class="admonition danger">
<p class="admonition-title">Large <code>ks</code></p>
<p>This simply cannot be stressed enough! It is just too easy to overshoot the range at which the exponential expansion region is valid!</p>
</div>
<p>Let's revisit the example of the previous section:</p>
<div class="codehilite"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">henon</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>The timeseries of length 100000 could be considered big. A time length of 100 seems very small. Yet it turns out it is way too big! The following</p>
<div class="codehilite"><pre><span></span><span class="n">ks</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">100</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">Reconstruction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">numericallyapunov</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">FixedMassNeighborhood</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="o">-</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;Lyappunov: &quot;</span><span class="p">,</span> <span class="n">linear_region</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">E</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>


<p>gives this plot: <img alt="Bad time-vector example" src="https://i.imgur.com/wbpuBis.png" /> and prints</p>
<div class="codehilite"><pre><span></span><span class="n">Lyapunov</span><span class="o">:</span> <span class="mf">0.4161</span><span class="o">...</span>
</pre></div>


<p>Notice that even though this value for the Lyapunov exponent is correct, it happened to be correct simply due to the jitter of the saturated region. Since the saturated region is much bigger than the linear scaling region, if it wasn't that jittery the function <a href="../entropies/#ChaosTools.linear_region"><code>linear_region</code></a> would not give the scaling of the linear region, but instead a slope near 0! (or if you were to give bigger tolerance as a keyword argument)</p>
<p><a id='Case-of-a-Continuous-system-1'></a></p>
<h3 id="case-of-a-continuous-system">Case of a Continuous system</h3>
<p>The process for continuous systems works identically with discrete, but one must be a bit more thoughtful when choosing parameters. The following example has comments to help the users get familiar with the process:</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">DynamicalSystems</span><span class="p">,</span> <span class="n">PyPlot</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">lorenz</span><span class="p">()</span> <span class="c"># Max lyapunov is around 0.90</span>
<span class="c"># create a timeseries of 1 dimension</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="p">)[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c"># Reconstruct it</span>
<span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">D</span> <span class="kp">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">τ</span> <span class="kp">in</span> <span class="p">[</span><span class="n">τ1</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">Reconstruction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">τ</span><span class="p">)</span>

    <span class="c"># I now know that I have to use much bigger ks than 1:20, because this is a</span>
    <span class="c"># continuous case! (See reference given in `numericallyapunovs`)</span>
    <span class="n">ks1</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="mi">200</span>
    <span class="c"># I also know that I do not need that dense computations, since 1 increment</span>
    <span class="c"># in k means increment of 0.05 real time</span>
    <span class="n">ks2</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="mi">200</span>

    <span class="c"># Calculate lyapunovs:</span>
    <span class="n">method</span> <span class="o">=</span> <span class="n">FixedMassNeighborhood</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">#5 nearest neighbors of each state</span>

    <span class="c"># E1 = numericallyapunov(R, ks1; method = method)</span>
    <span class="c"># λ1 = linear_region(ks1 .* dt, E1)[2]</span>
    <span class="n">E2</span> <span class="o">=</span> <span class="n">numericallyapunov</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">ks2</span><span class="p">;</span> <span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="p">)</span>
    <span class="n">λ2</span> <span class="o">=</span> <span class="n">linear_region</span><span class="p">(</span><span class="n">ks2</span> <span class="o">.*</span> <span class="n">dt</span><span class="p">,</span> <span class="n">E2</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>


    <span class="c"># plot(ks1,E1.-E1[1], label = &quot;dense, D=$(D), τ=$(τ), λ=$(round(λ1, 3))&quot;)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">ks2</span><span class="p">,</span><span class="n">E2</span><span class="o">.-</span><span class="n">E2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;D=</span><span class="si">$</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="s">, τ=</span><span class="si">$</span><span class="p">(</span><span class="n">τ</span><span class="p">)</span><span class="s">, λ=</span><span class="si">$</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">λ2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;k (0.05×t)&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;E - E(0)&quot;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Continuous Reconstruction Lyapunov&quot;</span><span class="p">)</span>
<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>


<p>which produces: <img alt="Continuous Reconstruction exaple" src="https://i.imgur.com/lgyGLDv.png" /> As you can see, using <code>τ = 15</code> makes almost no sense! The estimates with <code>τ = 7</code> though are very good (the actual value is around <code>λ ≈ 0.89...</code>).</p>
<p><a id='Broomhead-King-Coordinates-1'></a></p>
<h2 id="broomhead-king-coordinates">Broomhead-King Coordinates</h2>
<p><a id='ChaosTools.broomhead_king' href='#ChaosTools.broomhead_king'>#</a>
<strong><code>ChaosTools.broomhead_king</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>broomhead_king(s::AbstractVector, d::Int) -&gt; U, S, Vtr
</pre></div>


<p>Return the Broomhead-King coordinates of a timeseries <code>s</code> by performing <code>svd</code> on the so-called trajectory matrix with dimension <code>d</code>.</p>
<p><strong>Description</strong></p>
<p>Broomhead and King coordinates is a method proposed in [1] that applies the Karhunen–Loève theorem to delay coordinates embedding with smallest possible delay.</p>
<p>The function performs singular value decomposition on the <code>d</code>-dimensional trajectory matrix <span><span class="MathJax_Preview">X</span><script type="math/tex">X</script></span> of <span><span class="MathJax_Preview">s</span><script type="math/tex">s</script></span>,</p>
<div>
<div class="MathJax_Preview">
X = \frac{1}{\sqrt{N}}\left(
\begin{array}{cccc}
x_1 &amp; x_2 &amp; \ldots &amp; x_d \\
x_2 &amp; x_3 &amp; \ldots &amp; x_{d+1}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_{N-d+1} &amp; x_{N-d+2} &amp;\ldots &amp; x_N
\end{array}
\right) = U\cdot S \cdot V^{tr}.
</div>
<script type="math/tex; mode=display">
X = \frac{1}{\sqrt{N}}\left(
\begin{array}{cccc}
x_1 & x_2 & \ldots & x_d \\
x_2 & x_3 & \ldots & x_{d+1}\\
\vdots & \vdots & \vdots & \vdots \\
x_{N-d+1} & x_{N-d+2} &\ldots & x_N
\end{array}
\right) = U\cdot S \cdot V^{tr}.
</script>
</div>
<p>where <span><span class="MathJax_Preview">x := s - \bar{s}</span><script type="math/tex">x := s - \bar{s}</script></span>. The columns of <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> can then be used as a new coordinate system, and by considering the values of the singular values <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> you can decide how many columns of <span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span> are "important". See the documentation page for example application.</p>
<p><strong>References</strong></p>
<p>[1] :  D. S. Broomhead, R. Jones and G. P. King, J. Phys. A <strong>20</strong>, 9, pp L563 (1987)</p>
<p><a target='_blank' href='https://github.com/JuliaDynamics/ChaosTools.jl/blob/a0b9291018ff89e1407790baea99d060431bb170/src/nlts.jl#L180-L208' class='documenter-source'>source</a><br></p>
<hr />
<p>This alternative/improvement of the traditional delay coordinates can be a very powerful tool. An example where it shines is noisy data where there is the effect of superficial dimensions due to noise.</p>
<p>Take the following example where we produce noisy data from a system and then use Broomhead-King coordinates as an alternative to "vanilla" delay coordinates:</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">DynamicalSystems</span><span class="p">,</span> <span class="n">PyPlot</span>
<span class="k">using</span> <span class="n">Distributions</span> <span class="c"># for random numbers</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">gissinger</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">distrib</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">x</span> <span class="o">.+</span> <span class="n">rand</span><span class="p">(</span><span class="n">distrib</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>

<span class="n">U</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">broomhead_king</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Broomhead-King of s&quot;</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">Reconstruction</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">columns</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">...</span><span class="p">;</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;C3&quot;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;2D Reconstruction of s&quot;</span><span class="p">)</span>

<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>


<p><img alt="Broomhead-King example" src="https://i.imgur.com/xVWDjuh.png" /></p>
<p>we have used the same system as in the <a href="../../definition/reconstruction">delay coordinates reconstruction</a> example, and picked the optimal delay time of <code>τ = 30</code> (for same <code>dt = 0.05</code>). Regardless, the vanilla delay coordinates fail spectacularly when compared with the Broomhead-King coordinates.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../entropies/" title="Entropies and Dimensions" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Entropies and Dimensions
              </span>
            </div>
          </a>
        
        
          <a href="../periodicity/" title="Periodicity" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Periodicity
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
        <script src="../../assets\mathjaxhelper.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>