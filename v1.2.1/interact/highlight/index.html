



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A Julia software library for the exploration of chaos and nonlinear dynamics.">
      
      
      
        <meta name="author" content="George Datseris">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Trajectory Highlighter - DynamicalSystems.jl</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,400,400i,700|Source+Code+Pro">
        <style>body,input{font-family:"Montserrat","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../assets\Documenter.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#trajectory-highlighter" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="DynamicalSystems.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                DynamicalSystems.jl
              </span>
              <span class="md-header-nav__topic">
                Trajectory Highlighter
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="DynamicalSystems.jl" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    DynamicalSystems.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction & Contents" class="md-nav__link">
      Introduction & Contents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      DynamicalSystemsBase
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        DynamicalSystemsBase
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ds/general/" title="Dynamical System Definition" class="md-nav__link">
      Dynamical System Definition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ds/evolve/" title="Time Evolution" class="md-nav__link">
      Time Evolution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ds/predefined/" title="Predefined Systems" class="md-nav__link">
      Predefined Systems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      DelayEmbeddings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        DelayEmbeddings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../embedding/dataset/" title="Numerical Data" class="md-nav__link">
      Numerical Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../embedding/reconstruction/" title="Delay Coordinates" class="md-nav__link">
      Delay Coordinates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../embedding/estimate/" title="Estimating Delay Embedding Parameters" class="md-nav__link">
      Estimating Delay Embedding Parameters
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      ChaosTools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        ChaosTools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/overview/" title="Features Overview" class="md-nav__link">
      Features Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/orbitdiagram/" title="Orbit Diagrams & PSOS" class="md-nav__link">
      Orbit Diagrams & PSOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/lyapunovs/" title="Lyapunov Exponents" class="md-nav__link">
      Lyapunov Exponents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/chaos_detection/" title="Chaos Distinction" class="md-nav__link">
      Chaos Distinction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/entropies/" title="Entropies and Dimensions" class="md-nav__link">
      Entropies and Dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/nlts/" title="Nonlinear Timeseries Analysis" class="md-nav__link">
      Nonlinear Timeseries Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/periodicity/" title="Periodicity" class="md-nav__link">
      Periodicity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/choosing/" title="Choosing a solver" class="md-nav__link">
      Choosing a solver
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      RecurrenceAnalysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        RecurrenceAnalysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../rqa/rplots/" title="Recurrence Plots" class="md-nav__link">
      Recurrence Plots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rqa/quantification/" title="Quantification & Analysis functions" class="md-nav__link">
      Quantification & Analysis functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rqa/windowed/" title="Windowed RQA" class="md-nav__link">
      Windowed RQA
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      InteractiveChaos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        InteractiveChaos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../od/" title="Orbit Diagram" class="md-nav__link">
      Orbit Diagram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../psos/" title="Poincaré Surface of Section" class="md-nav__link">
      Poincaré Surface of Section
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Trajectory Highlighter
      </label>
    
    <a href="./" title="Trajectory Highlighter" class="md-nav__link md-nav__link--active">
      Trajectory Highlighter
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docstrings" title="Docstrings" class="md-nav__link">
    Docstrings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-video" title="Function Video" class="md-nav__link">
    Function Video
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../advanced/" title="Advanced Documentation" class="md-nav__link">
      Advanced Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributors_guide/" title="Contributor Guide" class="md-nav__link">
      Contributor Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../news/" title="News" class="md-nav__link">
      News
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docstrings" title="Docstrings" class="md-nav__link">
    Docstrings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-video" title="Function Video" class="md-nav__link">
    Function Video
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/edit/master/docs/interact/highlight.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='Trajectory-Highlighter-1'></a></p>
<h1 id="trajectory-highlighter">Trajectory Highlighter</h1>
<p><a id='Docstrings-1'></a></p>
<h2 id="docstrings">Docstrings</h2>
<p><a id='InteractiveChaos.trajectory_highlighter' href='#InteractiveChaos.trajectory_highlighter'>#</a>
<strong><code>InteractiveChaos.trajectory_highlighter</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span><span class="n">trajectory_highlighter</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">vals</span><span class="p">;</span> <span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
</pre></div>


<p>Open an interactive application for highlighting specific datasets and properties of these datasets. <code>datasets</code> is a vector of <em>anything</em> from <strong>DynamicalSystems.jl</strong> that supports <code>plot_dataset</code> (currently <code>Dataset</code> or <code>Matrix</code>). Each dataset corresponds to a specific value from <code>vals</code> (a <code>Vector{&lt;:Real}</code>). The value of <code>vals</code> gives each dataset a specific color based on a colormap.</p>
<p>The application is composed of two scenes: the left scene plots the datasets, while the right scene plots the histogram of the <code>vals</code>. The function returns the two scenes <code>data_scene, hist_scene</code>.</p>
<p><strong>Interaction</strong></p>
<p>Clicking on a bin of the histogram plot will "highlight" all data whose value belongs in that bin. Here highlighting actually means "hidding" (i.e. reducing their alpha value) all other data besides the ones you want to highlight. Clicking on empty space on the histogram plot will reset highlighting.</p>
<p>Clicking on a plotted series in the left window will highlight this series as well as the histogram bin that contains its value. Clicking on empty space will reset the highlighting.</p>
<p><strong>Keyword Arguments</strong></p>
<ul>
<li><code>nbins = 10, closed = :left</code> : used in producing the histogram.</li>
<li><code>α = 0.05</code> : the alpha value of the hidden data.</li>
<li><code>hα = 0.2</code> : the alpha value of the hidden histogram bins.</li>
<li><code>cmap = :viridis</code> : the colormap used.</li>
<li><code>hname = "value"</code> : name for the histogram axis.</li>
<li><code>kwargs...</code> : Anything else is propagated to <code>plot_dataset</code>.</li>
</ul>
<p><a id='Function-Video-1'></a></p>
<h2 id="function-video">Function Video</h2>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">InteractiveChaos</span><span class="p">,</span> <span class="n">Makie</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">henonheiles</span><span class="p">()</span>

<span class="c"># Grid of initial conditions at given energy:</span>
<span class="n">energy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">px</span><span class="p">,</span><span class="n">py</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">(</span><span class="n">px</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">py</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">potential</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">potential</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="k">function</span> <span class="n">generate_ics</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">pys</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">ics</span> <span class="o">=</span> <span class="kt">Vector</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}}()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="kp">in</span> <span class="n">ys</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">potential</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">V</span> <span class="o">≥</span> <span class="n">E</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
        <span class="k">for</span> <span class="n">py</span> <span class="kp">in</span> <span class="n">pys</span>
            <span class="n">Ky</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">py</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">Ky</span> <span class="o">+</span> <span class="n">V</span> <span class="o">≥</span> <span class="n">E</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
            <span class="n">px</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">(</span><span class="n">E</span> <span class="o">-</span> <span class="n">V</span> <span class="o">-</span> <span class="n">Ky</span><span class="p">))</span>
            <span class="n">ic</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">]</span>
            <span class="n">push!</span><span class="p">(</span><span class="n">ics</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">])</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">ics</span>
<span class="k">end</span>

<span class="n">density</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">2000.0</span>
<span class="n">tgali</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">0.13</span>
<span class="n">ics</span> <span class="o">=</span> <span class="n">generate_ics</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">density</span><span class="p">)</span>

<span class="n">tinteg</span> <span class="o">=</span> <span class="n">tangent_integrator</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">regularity</span> <span class="o">=</span> <span class="kt">Float64</span><span class="p">[];</span> <span class="n">psos</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="kt">Float64</span><span class="p">}[]</span>
<span class="n">trs</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="kt">Float64</span><span class="p">}[]</span>
<span class="nd">@time</span> <span class="k">for</span> <span class="n">u</span> <span class="kp">in</span> <span class="n">ics</span>
    <span class="c"># compute gali (using advanced usage)</span>
    <span class="n">reinit!</span><span class="p">(</span><span class="n">tinteg</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">orthonormal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">push!</span><span class="p">(</span><span class="n">regularity</span><span class="p">,</span> <span class="n">gali</span><span class="p">(</span><span class="n">tinteg</span><span class="p">,</span> <span class="n">tgali</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)[</span><span class="mi">2</span><span class="p">][</span><span class="k">end</span><span class="p">]</span><span class="o">/</span><span class="n">tgali</span><span class="p">)</span>
    <span class="n">push!</span><span class="p">(</span><span class="n">psos</span><span class="p">,</span> <span class="n">poincaresos</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mf">2000.0</span><span class="p">;</span> <span class="n">u0</span> <span class="o">=</span> <span class="n">u</span><span class="p">,</span> <span class="n">idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">,</span> <span class="n">u</span><span class="p">)[</span><span class="o">:</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
    <span class="n">push!</span><span class="p">(</span><span class="n">trs</span><span class="p">,</span> <span class="n">tr</span><span class="p">)</span>
<span class="k">end</span>

<span class="c"># %%</span>
<span class="c"># 2D version:</span>
<span class="n">trajectory_highlighter</span><span class="p">(</span><span class="n">psos</span><span class="p">,</span> <span class="n">regularity</span><span class="p">;</span> <span class="n">α</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">hname</span> <span class="o">=</span> <span class="s">&quot;regularity&quot;</span><span class="p">)</span>
<span class="c"># 3D version:</span>
<span class="n">trajectory_highlighter</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="k">end</span><span class="p">],</span> <span class="n">regularity</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="k">end</span><span class="p">];</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">α</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">hname</span> <span class="o">=</span> <span class="s">&quot;regularity&quot;</span><span class="p">)</span>
</pre></div>


<p>2D Version:</p>
<video width="100%" height="auto" controls autoplay loop> <source src="https://raw.githubusercontent.com/JuliaDynamics/JuliaDynamics/master/videos/interact/highlighter2D.mp4?raw=true" type="video/mp4"> </video>

<p>3D Version:</p>
<video width="100%" height="auto" controls autoplay loop> <source src="https://raw.githubusercontent.com/JuliaDynamics/JuliaDynamics/master/videos/interact/highlighter3D.mp4?raw=true" type="video/mp4"> </video>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../psos/" title="Poincaré Surface of Section" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Poincaré Surface of Section
              </span>
            </div>
          </a>
        
        
          <a href="../../advanced/" title="Advanced Documentation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Advanced Documentation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../assets\mathjaxhelper.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>