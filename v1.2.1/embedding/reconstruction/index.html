



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A Julia software library for the exploration of chaos and nonlinear dynamics.">
      
      
      
        <meta name="author" content="George Datseris">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Delay Coordinates - DynamicalSystems.jl</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,400,400i,700|Source+Code+Pro">
        <style>body,input{font-family:"Montserrat","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../assets\Documenter.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#reconstructembed" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="DynamicalSystems.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                DynamicalSystems.jl
              </span>
              <span class="md-header-nav__topic">
                Delay Coordinates
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="DynamicalSystems.jl" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    DynamicalSystems.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction & Contents" class="md-nav__link">
      Introduction & Contents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      DynamicalSystemsBase
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        DynamicalSystemsBase
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ds/general/" title="Dynamical System Definition" class="md-nav__link">
      Dynamical System Definition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ds/evolve/" title="Time Evolution" class="md-nav__link">
      Time Evolution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ds/predefined/" title="Predefined Systems" class="md-nav__link">
      Predefined Systems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      DelayEmbeddings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        DelayEmbeddings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset/" title="Numerical Data" class="md-nav__link">
      Numerical Data
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Delay Coordinates
      </label>
    
    <a href="./" title="Delay Coordinates" class="md-nav__link md-nav__link--active">
      Delay Coordinates
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reconstructembed" title="Reconstruct/Embed" class="md-nav__link">
    Reconstruct/Embed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-functors" title="Embedding Functors" class="md-nav__link">
    Embedding Functors
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../estimate/" title="Estimating Delay Embedding Parameters" class="md-nav__link">
      Estimating Delay Embedding Parameters
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      ChaosTools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        ChaosTools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/overview/" title="Features Overview" class="md-nav__link">
      Features Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/orbitdiagram/" title="Orbit Diagrams & PSOS" class="md-nav__link">
      Orbit Diagrams & PSOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/lyapunovs/" title="Lyapunov Exponents" class="md-nav__link">
      Lyapunov Exponents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/chaos_detection/" title="Chaos Distinction" class="md-nav__link">
      Chaos Distinction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/entropies/" title="Entropies and Dimensions" class="md-nav__link">
      Entropies and Dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/nlts/" title="Nonlinear Timeseries Analysis" class="md-nav__link">
      Nonlinear Timeseries Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/periodicity/" title="Periodicity" class="md-nav__link">
      Periodicity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/choosing/" title="Choosing a solver" class="md-nav__link">
      Choosing a solver
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      RecurrenceAnalysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        RecurrenceAnalysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../rqa/rplots/" title="Recurrence Plots" class="md-nav__link">
      Recurrence Plots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rqa/quantification/" title="Quantification & Analysis functions" class="md-nav__link">
      Quantification & Analysis functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rqa/windowed/" title="Windowed RQA" class="md-nav__link">
      Windowed RQA
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      InteractiveChaos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        InteractiveChaos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interact/od/" title="Orbit Diagram" class="md-nav__link">
      Orbit Diagram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interact/psos/" title="Poincaré Surface of Section" class="md-nav__link">
      Poincaré Surface of Section
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interact/highlight/" title="Trajectory Highlighter" class="md-nav__link">
      Trajectory Highlighter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../advanced/" title="Advanced Documentation" class="md-nav__link">
      Advanced Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributors_guide/" title="Contributor Guide" class="md-nav__link">
      Contributor Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../news/" title="News" class="md-nav__link">
      News
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reconstructembed" title="Reconstruct/Embed" class="md-nav__link">
    Reconstruct/Embed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-functors" title="Embedding Functors" class="md-nav__link">
    Embedding Functors
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/edit/master/docs/embedding/reconstruction.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Delay Coordinates</h1>
                
                <p>A timeseries recorded in some manner from a dynamical system can be used to gain information about the dynamics of the entire phase-space of the system. This can be done by reconstructing a new phase-space from the timeseries. One method that can do this is what is known as <a href="https://en.wikipedia.org/wiki/Takens%27_theorem">delay coordinates embedding</a> or delay coordinates <em>reconstruction</em>.</p>
<p><a id='Reconstruct/Embed-1'></a></p>
<h2 id="reconstructembed">Reconstruct/Embed</h2>
<p>Delay embedding reconstructions are done through <code>reconstruct</code> or <code>embed</code>:</p>
<p><a id='DelayEmbeddings.reconstruct' href='#DelayEmbeddings.reconstruct'>#</a>
<strong><code>DelayEmbeddings.reconstruct</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span><span class="n">reconstruct</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">γ</span><span class="p">,</span> <span class="n">τ</span><span class="p">)</span>
</pre></div>


<p>Reconstruct <code>s</code> using the delay coordinates embedding with <code>γ</code> temporal neighbors and delay <code>τ</code> and return the result as a <a href="../dataset/#DelayEmbeddings.Dataset"><code>Dataset</code></a>.</p>
<p>See <a href="./#DelayEmbeddings.embed"><code>embed</code></a> for the version that accepts the embedding dimension <code>D = γ+1</code> directly.</p>
<p><strong>Description</strong></p>
<p><strong>Single Timeseries</strong></p>
<p>If <code>τ</code> is an integer, then the <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>-th entry of the embedded space is</p>
<div>
<div class="MathJax_Preview">
(s(n), s(n+\tau), s(n+2\tau), \dots, s(n+γ\tau))
</div>
<script type="math/tex; mode=display">
(s(n), s(n+\tau), s(n+2\tau), \dots, s(n+γ\tau))
</script>
</div>
<p>If instead <code>τ</code> is a vector of integers, so that <code>length(τ) == γ</code>, then the <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>-th entry is</p>
<div>
<div class="MathJax_Preview">
(s(n), s(n+\tau[1]), s(n+\tau[2]), \dots, s(n+\tau[γ]))
</div>
<script type="math/tex; mode=display">
(s(n), s(n+\tau[1]), s(n+\tau[2]), \dots, s(n+\tau[γ]))
</script>
</div>
<p>The reconstructed dataset can have same invariant quantities (like e.g. lyapunov exponents) with the original system that the timeseries were recorded from, for proper <code>γ</code> and <code>τ</code>. This is known as the Takens embedding theorem [1, 2]. The case of different delay times allows reconstructing systems with many time scales, see [3].</p>
<p><em>Notice</em> - The dimension of the returned dataset (i.e. embedding dimension) is <code>γ+1</code>!</p>
<p><strong>Multiple Timeseries</strong></p>
<p>To make a reconstruction out of a multiple timeseries (i.e. trajectory) the number of timeseries must be known by type, so <code>s</code> can be either:</p>
<ul>
<li><code>s::AbstractDataset{B}</code></li>
<li><code>s::SizedAray{A, B}</code></li>
</ul>
<p>If the trajectory is for example <span><span class="MathJax_Preview">(x, y)</span><script type="math/tex">(x, y)</script></span> and <code>τ</code> is integer, then the <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>-th entry of the embedded space is</p>
<div>
<div class="MathJax_Preview">
(x(n), y(n), x(n+\tau), y(n+\tau), \dots, x(n+γ\tau), y(n+γ\tau))
</div>
<script type="math/tex; mode=display">
(x(n), y(n), x(n+\tau), y(n+\tau), \dots, x(n+γ\tau), y(n+γ\tau))
</script>
</div>
<p>If <code>τ</code> is an <code>AbstractMatrix{Int}</code>, so that <code>size(τ) == (γ, B)</code>, then we have</p>
<div>
<div class="MathJax_Preview">
(x(n), y(n), x(n+\tau[1, 1]), y(n+\tau[1, 2]), \dots, x(n+\tau[γ, 1]), y(n+\tau[γ, 2]))
</div>
<script type="math/tex; mode=display">
(x(n), y(n), x(n+\tau[1, 1]), y(n+\tau[1, 2]), \dots, x(n+\tau[γ, 1]), y(n+\tau[γ, 2]))
</script>
</div>
<p><em>Notice</em> - The dimension of the returned dataset is <code>(γ+1)*B</code>!</p>
<p><strong>References</strong></p>
<p>[1] : F. Takens, <em>Detecting Strange Attractors in Turbulence — Dynamical Systems and Turbulence</em>, Lecture Notes in Mathematics <strong>366</strong>, Springer (1981)</p>
<p>[2] : T. Sauer <em>et al.</em>, J. Stat. Phys. <strong>65</strong>, pp 579 (1991)</p>
<p>[3] : K. Judd &amp; A. Mees, <a href="https://www.sciencedirect.com/science/article/pii/S0167278997001188">Physica D <strong>120</strong>, pp 273 (1998)</a></p>
<p><a id='DelayEmbeddings.embed' href='#DelayEmbeddings.embed'>#</a>
<strong><code>DelayEmbeddings.embed</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span><span class="n">embed</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">τ</span><span class="p">)</span>
</pre></div>


<p>Perform a delay coordinates embedding on signal <code>s</code> with embedding dimension <code>D</code> and delay time <code>τ</code>. The result is returned as a <a href="../dataset/#DelayEmbeddings.Dataset"><code>Dataset</code></a>, which is a vector of static vectors.</p>
<p>See <a href="./#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> for an advanced version that supports multiple delay times and can reconstruct multiple timeseries efficiently.</p>
<hr />
<p>Here are some examples of <code>reconstruct</code>ing a 3D continuous chaotic system:</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">DynamicalSystems</span><span class="p">,</span> <span class="n">PyPlot</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">gissinger</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">xyz</span> <span class="o">=</span> <span class="n">columns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span>
    <span class="k">for</span> <span class="n">τ</span> <span class="kp">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">τ</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;C</span><span class="si">$</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">title</span><span class="p">(</span><span class="s">&quot;var = </span><span class="si">$i</span><span class="s">, τ = </span><span class="si">$τ</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="kd">global</span> <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="n">tight_layout</span><span class="p">()</span>
<span class="n">suptitle</span><span class="p">(</span><span class="s">&quot;2D reconstructed space&quot;</span><span class="p">)</span>
<span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>


<p><img alt="" src="../simple_reconstruction.png" /></p>
<div class="admonition note">
<p class="admonition-title"><code>τ</code> and <code>dt</code></p>
<p>Keep in mind that whether a value of <code>τ</code> is "reasonable" for continuous systems depends on <code>dt</code>. In the above example the value <code>τ=30</code> is good, <em>only</em> for the case of using <code>dt = 0.05</code>. For shorter/longer <code>dt</code> one has to adjust properly <code>τ</code> so that their product <code>τ*dt</code> is the same.</p>
</div>
<p>You can also <code>reconstruct</code> multidimensional timeseries. For this to be possible, the number of timeseries must be known by Type:</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">StaticArrays</span><span class="o">:</span> <span class="n">Size</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c"># my trajectory</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">Size</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="n">a</span><span class="p">)</span> <span class="c"># create array with the size as Type information</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c">#aaaall good</span>
</pre></div>


<div class="codehilite"><pre><span></span>9-dimensional Dataset{Float64} with 996 points
 0.579701  0.583423  0.339023   0.387958  …  0.458677  0.540187  0.15168  
 0.154014  0.638022  0.775553   0.876439     0.660742  0.703415  0.722352 
 0.387958  0.801119  0.670552   0.458677     0.534543  0.19187   0.781235 
 0.876439  0.028197  0.435636   0.660742     0.73391   0.770822  0.101162 
 0.458677  0.540187  0.15168    0.534543     0.132827  0.631728  0.97861  
 0.660742  0.703415  0.722352   0.73391   …  0.475827  0.921796  0.0842604
 0.534543  0.19187   0.781235   0.132827     0.425608  0.294068  0.28675  
 0.73391   0.770822  0.101162   0.475827     0.817156  0.848518  0.481871 
 0.132827  0.631728  0.97861    0.425608     0.254286  0.133701  0.577632 
 0.475827  0.921796  0.0842604  0.817156     0.218876  0.560254  0.0557962
 ⋮                                        ⋱                               
 0.248187  0.986588  0.0440588  0.879716     0.578812  0.25225   0.314532 
 0.442136  0.472563  0.598415   0.640914     0.319494  0.250638  0.438317 
 0.879716  0.612561  0.745464   0.578812     0.561302  0.25014   0.19985  
 0.640914  0.9293    0.441654   0.319494     0.650796  0.904613  0.902537 
 0.578812  0.25225   0.314532   0.561302  …  0.602465  0.715249  0.394259 
 0.319494  0.250638  0.438317   0.650796     0.67249   0.533966  0.885619 
 0.561302  0.25014   0.19985    0.602465     0.300294  0.662834  0.907772 
 0.650796  0.904613  0.902537   0.67249      0.554132  0.589441  0.539833 
 0.602465  0.715249  0.394259   0.300294     0.637452  0.845935  0.169613 
</pre></div>


<div class="codehilite"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">Systems</span><span class="o">.</span><span class="n">towel</span><span class="p">();</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># Dataset size is also known by Type!</span>
</pre></div>


<div class="codehilite"><pre><span></span>9-dimensional Dataset{Float64} with 9997 points
 0.085     -0.121       0.075     …  0.837347   0.0372633   0.555269
 0.285813  -0.0675286   0.238038     0.51969    0.0616256   0.940906
 0.76827   -0.038933    0.672094     0.966676  -0.00171595  0.2225  
 0.681871   0.0508933   0.825263     0.112748   0.0674955   0.653573
 0.837347   0.0372633   0.555269     0.386547  -0.0886542   0.869349
 0.51969    0.0616256   0.940906  …  0.910741  -0.0316828   0.411607
 0.966676  -0.00171595  0.2225       0.306095   0.0689305   0.909129
 0.112748   0.0674955   0.653573     0.824263  -0.056185    0.326064
 0.386547  -0.0886542   0.869349     0.545332   0.0508239   0.819404
 0.910741  -0.0316828   0.411607     0.954994   0.00453815  0.569534
 ⋮                                ⋱                                 
 0.914702  -0.0315439   0.294266     0.90246    0.0242141   0.539502
 0.289932   0.0641239   0.778698     0.335976   0.0735803   0.943945
 0.793854  -0.0552801   0.664223     0.86657   -0.0497658   0.214728
 0.62671    0.0557527   0.832001     0.430816   0.0535742   0.62743 
 0.90246    0.0242141   0.539502  …  0.936955  -0.0200112   0.894333
 0.335976   0.0735803   0.943945     0.237481   0.0983265   0.353212
 0.86657   -0.0497658   0.214728     0.681538  -0.0476555   0.883219
 0.430816   0.0535742   0.62743      0.836353   0.0363264   0.380351
 0.936955  -0.0200112   0.894333     0.515471   0.0534613   0.898152
</pre></div>


<p><a id='Embedding-Functors-1'></a></p>
<h2 id="embedding-functors">Embedding Functors</h2>
<p>The high level functions <a href="./#DelayEmbeddings.embed"><code>embed</code></a>, <a href="./#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> utilize a low-level interface for creating embedded vectors on-the-fly. The high level interface simply loops over the low level interface. The low level interface is composed of the following two structures:</p>
<p><a id='DelayEmbeddings.DelayEmbedding' href='#DelayEmbeddings.DelayEmbedding'>#</a>
<strong><code>DelayEmbeddings.DelayEmbedding</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span><span class="n">DelayEmbedding</span><span class="p">(</span><span class="nb">γ</span><span class="p">,</span> <span class="n">τ</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="sb">`embedding`</span>
</pre></div>


<p>Return a delay coordinates embedding structure to be used as a functor, given a timeseries and some index. Calling</p>
<div class="codehilite"><pre><span></span><span class="n">embedding</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>


<p>will create the <code>n</code>-th reconstructed vector of the embedded space, which has <code>γ</code> temporal neighbors with delay(s) <code>τ</code>. See <a href="./#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> for more.</p>
<p><strong>Be very careful when choosing <code>n</code>, because <code>@inbounds</code> is used internally.</strong></p>
<p><a id='DelayEmbeddings.MTDelayEmbedding' href='#DelayEmbeddings.MTDelayEmbedding'>#</a>
<strong><code>DelayEmbeddings.MTDelayEmbedding</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span><span class="n">MTDelayEmbedding</span><span class="p">(</span><span class="nb">γ</span><span class="p">,</span> <span class="n">τ</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="sb">`embedding`</span>
</pre></div>


<p>Return a delay coordinates embedding structure to be used as a functor, given multiple timeseries (<code>B</code> in total), either as a <a href="../dataset/#DelayEmbeddings.Dataset"><code>Dataset</code></a> or a <code>SizedArray</code>), and some index. Calling</p>
<div class="codehilite"><pre><span></span><span class="n">embedding</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>


<p>will create the <code>n</code>-th reconstructed vector of the embedded space, which has <code>γ</code> temporal neighbors with delay(s) <code>τ</code>. See <a href="./#DelayEmbeddings.reconstruct"><code>reconstruct</code></a> for more.</p>
<p><strong>Be very careful when choosing <code>n</code>, because <code>@inbounds</code> is used internally.</strong></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../dataset/" title="Numerical Data" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Numerical Data
              </span>
            </div>
          </a>
        
        
          <a href="../estimate/" title="Estimating Delay Embedding Parameters" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Estimating Delay Embedding Parameters
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../assets\mathjaxhelper.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>