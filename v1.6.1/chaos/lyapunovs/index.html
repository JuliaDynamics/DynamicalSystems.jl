<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lyapunov Exponents · DynamicalSystems.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DynamicalSystems.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DynamicalSystems.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../contents/">Contents</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Dynamical systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ds/general/">Dynamical System Definition</a></li><li><a class="tocitem" href="../../ds/predefined/">Predefined Dynamical Systems</a></li><li><a class="tocitem" href="../../embedding/dataset/">Numerical Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">DelayEmbeddings</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../embedding/reconstruction/">Delay Coordinates Embedding</a></li><li><a class="tocitem" href="../../embedding/estimate/">Optimal DCE Parameters</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">ChaosTools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../orbitdiagram/">Orbit Diagrams &amp; PSOS</a></li><li class="is-active"><a class="tocitem" href>Lyapunov Exponents</a><ul class="internal"><li><a class="tocitem" href="#Concept-of-the-Lyapunov-exponent-1"><span>Concept of the Lyapunov exponent</span></a></li><li><a class="tocitem" href="#Lyapunov-Spectrum-1"><span>Lyapunov Spectrum</span></a></li><li><a class="tocitem" href="#Maximum-Lyapunov-Exponent-1"><span>Maximum Lyapunov Exponent</span></a></li></ul></li><li><a class="tocitem" href="../chaos_detection/">Detecting &amp; Categorizing Chaos</a></li><li><a class="tocitem" href="../entropies/">Entropies and Dimensions</a></li><li><a class="tocitem" href="../nlts/">Nonlinear Timeseries Analysis</a></li><li><a class="tocitem" href="../periodicity/">Periodicity &amp; Ergodicity</a></li><li><a class="tocitem" href="../choosing/">Choosing a solver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">RecurrenceAnalysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../rqa/rplots/">Recurrence Plots</a></li><li><a class="tocitem" href="../../rqa/quantification/">Recurrence Quantification Analysis</a></li><li><a class="tocitem" href="../../rqa/windowed/">Windowed RQA</a></li></ul></li><li><a class="tocitem" href="../../advanced/">Advanced Documentation</a></li><li><a class="tocitem" href="../../contributors_guide/">Contributor Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ChaosTools</a></li><li class="is-active"><a href>Lyapunov Exponents</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lyapunov Exponents</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/blob/master/docs/src/chaos/lyapunovs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Lyapunov-Exponents-1"><a class="docs-heading-anchor" href="#Lyapunov-Exponents-1">Lyapunov Exponents</a><a class="docs-heading-anchor-permalink" href="#Lyapunov-Exponents-1" title="Permalink"></a></h1><p>Lyapunov exponents measure exponential rates of separation of nearby trajectories in the flow of a dynamical system. The <a href="https://en.wikipedia.org/wiki/Lyapunov_exponent">Wikipedia</a> and the <a href="http://www.scholarpedia.org/article/Lyapunov_exponent">Scholarpedia</a> entries have a lot of valuable information about the history and usage of these quantities.</p><p>This page treats systems where the equations of motion are known. If instead you have numerical data, see <a href="../nlts/#ChaosTools.numericallyapunov"><code>numericallyapunov</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Performance depends on the solver</header><div class="admonition-body"><p>Notice that the performance of functions that use <code>ContinuousDynamicalSystem</code>s depend crucially on the chosen solver. Please see the documentation page on <a href="../choosing/#Choosing-a-solver-1">Choosing a solver</a> for an in-depth discussion.</p></div></div><h2 id="Concept-of-the-Lyapunov-exponent-1"><a class="docs-heading-anchor" href="#Concept-of-the-Lyapunov-exponent-1">Concept of the Lyapunov exponent</a><a class="docs-heading-anchor-permalink" href="#Concept-of-the-Lyapunov-exponent-1" title="Permalink"></a></h2><p>Before providing the documentation of the offered functionality, it is good to demonstrate exactly <em>what</em> are the Lyapunov exponents.</p><p>For chaotic systems, nearby trajectories separate in time exponentially fast (while for stable systems they come close exponentially fast). This happens at least for small separations, and is demonstrated in the following sketch:</p><p><img src="../lyapunov.png" alt/>.</p><p>In this sketch <span>$\lambda$</span> is the maximum Lyapunov exponent (and in general a system has as many exponents as its dimensionality).</p><p>Let&#39;s demonstrate these concepts using a real system, the Henon map:</p><div>\[\begin{aligned}
x_{n+1} &amp;= 1 - ax_n^2 + y_n \\
y_{n+1} &amp;= bx_n
\end{aligned}\]</div><p>Let&#39;s get a trajectory</p><pre><code class="language-julia">using DynamicalSystems, PyPlot
henon = Systems.henon()
tr1 = trajectory(henon, 100)
summary(tr1)</code></pre><pre><code class="language-none">&quot;2-dimensional Dataset{Float64} with 101 points&quot;</code></pre><p>and create one more trajectory that starts very close to the first one</p><pre><code class="language-julia">u2 = get_state(henon) + (1e-9 * ones(dimension(henon)))
tr2 = trajectory(henon, 100, u2)
summary(tr2)</code></pre><pre><code class="language-none">&quot;2-dimensional Dataset{Float64} with 101 points&quot;</code></pre><p>We now want to demonstrate how the distance between these two trajectories increases with time:</p><pre><code class="language-julia">using LinearAlgebra: norm

figure(figsize=(8,5))

# Plot the x-coordinate of the two trajectories:
ax1 = subplot(2,1,1)
plot(tr1[:, 1], alpha = 0.5)
plot(tr2[:, 1], alpha = 0.5)
ylabel(&quot;x&quot;)

# Plot their distance in a semilog plot:
ax2 = subplot(2,1,2, sharex = ax1)
d = [norm(tr1[i] - tr2[i]) for i in 1:length(tr2)]
ylabel(&quot;d&quot;); xlabel(&quot;n&quot;); semilogy(d);</code></pre><p><img src="../demonstration.png" alt/></p><p>The <em>initial</em> slope of the <code>d</code> vs <code>n</code> plot (before the curve saturates) is approximately the maximum Lyapunov exponent!</p><h2 id="Lyapunov-Spectrum-1"><a class="docs-heading-anchor" href="#Lyapunov-Spectrum-1">Lyapunov Spectrum</a><a class="docs-heading-anchor-permalink" href="#Lyapunov-Spectrum-1" title="Permalink"></a></h2><p>The function <code>lyapunovs</code> calculates the entire spectrum of the Lyapunov exponents of a system:</p><article class="docstring"><header><a class="docstring-binding" id="ChaosTools.lyapunovs" href="#ChaosTools.lyapunovs"><code>ChaosTools.lyapunovs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">lyapunovs(ds::DynamicalSystem, N [, k::Int | Q0]; kwargs...) -&gt; λs</code></pre><p>Calculate the spectrum of Lyapunov exponents <sup class="footnote-reference"><a id="citeref-Lyapunov1992" href="#footnote-Lyapunov1992">[Lyapunov1992]</a></sup> of <code>ds</code> by applying a QR-decomposition on the parallelepiped matrix <code>N</code> times. Return the spectrum sorted from maximum to minimum.</p><p>The third argument <code>k</code> is optional, and dictates how many lyapunov exponents to calculate (defaults to <code>dimension(ds)</code>). Instead of passing an integer <code>k</code> you can pass a pre-initialized matrix <code>Q0</code> whose columns are initial deviation vectors (then <code>k = size(Q0)[2]</code>).</p><p><strong>Keyword Arguments</strong></p><ul><li><code>u0 = get_state(ds)</code> : State to start from.</li><li><code>Ttr = 0</code> : Extra &quot;transient&quot; time to evolve the system before application of the algorithm. Should be <code>Int</code> for discrete systems. Both the system and the deviation vectors are evolved for this time.</li><li><code>dt = 1</code> : Time of individual evolutions between successive orthonormalization steps. For continuous systems this is approximate.</li><li><code>diffeq...</code> : Keyword arguments propagated into <code>init</code> of DifferentialEquations.jl. See <a href="../../ds/general/#DynamicalSystemsBase.trajectory"><code>trajectory</code></a> for examples. Only valid for continuous systems.</li></ul><p><strong>Description</strong></p><p>The method we employ is &quot;H2&quot; of <sup class="footnote-reference"><a id="citeref-Geist1990" href="#footnote-Geist1990">[Geist1990]</a></sup>, originally stated in <sup class="footnote-reference"><a id="citeref-Benettin1980" href="#footnote-Benettin1980">[Benettin1980]</a></sup>. The deviation vectors defining a <code>D</code>-dimensional parallepiped in tangent space are evolved using the tangent dynamics of the system. A QR-decomposition at each step yields the local growth rate for each dimension of the parallepiped. The growth rates are then averaged over <code>N</code> successive steps, yielding the lyapunov exponent spectrum (at each step the parallepiped is re-normalized).</p><p><strong>Performance Notes</strong></p><p>This function uses a <a href="../../advanced/#DynamicalSystemsBase.tangent_integrator"><code>tangent_integrator</code></a>. For loops over initial conditions and/or parameter values one should use the low level method that accepts an integrator, and <code>reinit!</code> it to new initial conditions. See the &quot;advanced documentation&quot; for info on the integrator object. The low level method is</p><pre><code class="language-julia">lyapunovs(tinteg, N, dt::Real, Ttr::Real)</code></pre><p>If you want to obtain the convergence timeseries of the Lyapunov spectrum, use the method</p><pre><code class="language-julia">ChaosTools.lyapunovs_convergence(tinteg, N, dt, Ttr)</code></pre><p>(not exported).</p></div></section></article><hr/><p>As you can see, the documentation string is detailed and self-contained. For example, the Lyapunov spectrum of the <a href="http://www.scholarpedia.org/article/Hyperchaos">folded towel map</a> is calculated as:</p><pre><code class="language-julia">using DynamicalSystems

ds = Systems.towel()
λλ = lyapunovs(ds, 10000)</code></pre><pre><code class="language-none">3-element Array{Float64,1}:
  0.43240930522213433
  0.3721773634212749
 -3.296958962934722</code></pre><p>Similarly, for a continuous system, e.g. the Lorenz system, you would do:</p><pre><code class="language-julia">lor = Systems.lorenz(ρ = 32.0) #this is not the original parameter!
λλ = lyapunovs(lor, 10000, dt = 0.1)</code></pre><pre><code class="language-none">3-element Array{Float64,1}:
   0.9881492815070998
  -0.0009001543936533155
 -14.65389696421011</code></pre><p><code>lyapunovs</code> is also very fast:</p><pre><code class="language-julia">using BenchmarkTools
ds = Systems.towel()
@btime lyapunovs($ds, 2000);</code></pre><pre><code class="language-none">  237.226 μs (45 allocations: 4.27 KiB)</code></pre><p>Here is an example of plotting the exponents of the Henon map for various parameters:</p><pre><code class="language-julia">using DynamicalSystems, PyPlot

he = Systems.henon()
as = 0.8:0.005:1.225; λs = zeros(length(as), 2)
for (i, a) in enumerate(as)
    set_parameter!(he, 1, a)
    λs[i, :] .= lyapunovs(he, 10000; Ttr = 500)
end

figure()
plot(as, λs); xlabel(&quot;\$a\$&quot;); ylabel(&quot;\$\\lambda\$&quot;)</code></pre><p><img src="../heλ.png" alt/></p><h2 id="Maximum-Lyapunov-Exponent-1"><a class="docs-heading-anchor" href="#Maximum-Lyapunov-Exponent-1">Maximum Lyapunov Exponent</a><a class="docs-heading-anchor-permalink" href="#Maximum-Lyapunov-Exponent-1" title="Permalink"></a></h2><p>It is possible to get only the maximum Lyapunov exponent simply by giving <code>1</code> as the third argument of <a href="#ChaosTools.lyapunovs"><code>lyapunovs</code></a>. However, there is a second algorithm that allows you to do the same thing, which is offered by the function <code>lyapunov</code>:</p><article class="docstring"><header><a class="docstring-binding" id="ChaosTools.lyapunov" href="#ChaosTools.lyapunov"><code>ChaosTools.lyapunov</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">lyapunov(ds::DynamicalSystem, Τ; kwargs...) -&gt; λ</code></pre><p>Calculate the maximum Lyapunov exponent <code>λ</code> using a method due to Benettin <sup class="footnote-reference"><a id="citeref-Benettin1976" href="#footnote-Benettin1976">[Benettin1976]</a></sup>, which simply evolves two neighboring trajectories (one called &quot;given&quot; and one called &quot;test&quot;) while constantly rescaling the test one. <code>T</code>  denotes the total time of evolution (should be <code>Int</code> for discrete systems).</p><p><strong>Keyword Arguments</strong></p><ul><li><code>Ttr = 0</code> : Extra &quot;transient&quot; time to evolve the trajectories before starting to measure the expontent. Should be <code>Int</code> for discrete systems.</li><li><code>d0 = 1e-9</code> : Initial &amp; rescaling distance between the two neighboring trajectories.</li><li><code>upper_threshold = 1e-6</code> : Upper distance threshold for rescaling.</li><li><code>lower_threshold = 1e-12</code> : Lower distance threshold for rescaling (in order to  be able to detect negative exponents).</li><li><code>dt = 1</code> : Time of evolution between each check of distance exceeding the thresholds. For continuous systems this is approximate.</li><li><code>inittest = (u1, d0) -&gt; u1 .+ d0/sqrt(D)</code> : A function that given <code>(u1, d0)</code> initializes the test state with distance <code>d0</code> from the given state <code>u1</code> (<code>D</code> is the dimension of the system). This function can be used when you want to avoid the test state appearing in a region of the phase-space where it would have e.g. different energy or escape to infinity.</li><li><code>diffeq...</code> : Keyword arguments propagated into <code>init</code> of DifferentialEquations.jl. See <a href="../../ds/general/#DynamicalSystemsBase.trajectory"><code>trajectory</code></a> for examples. Only valid for continuous systems.</li></ul><p><strong>Description</strong></p><p>Two neighboring trajectories with initial distance <code>d0</code> are evolved in time. At time <span>$t_i$</span> their distance <span>$d(t_i)$</span> either exceeds the <code>upper_threshold</code>, or is lower than <code>lower_threshold</code>, which initializes a rescaling of the test trajectory back to having distance <code>d0</code> from the given one, while the rescaling keeps the difference vector along the maximal expansion/contraction direction: <span>$u_2 \to u_1+(u_2−u_1)/(d(t_i)/d_0)$</span>.</p><p>The maximum Lyapunov exponent is the average of the time-local Lyapunov exponents</p><div>\[\lambda = \frac{1}{t_{n} - t_0}\sum_{i=1}^{n}
\ln\left( a_i \right),\quad a_i = \frac{d(t_{i})}{d_0}.\]</div><p><strong>Performance Notes</strong></p><p>This function uses a <a href="../../advanced/#DynamicalSystemsBase.parallel_integrator"><code>parallel_integrator</code></a>. For loops over initial conditions and/or parameter values one should use the low level method that accepts an integrator, and <code>reinit!</code> it to new initial conditions. See the &quot;advanced documentation&quot; for info on the integrator object. The low level method is</p><pre><code class="language-none">lyapunov(pinteg, T, Ttr, dt, d0, ut, lt)</code></pre></div></section></article><hr/><p>For example:</p><pre><code class="language-julia">using DynamicalSystems, PyPlot
henon = Systems.henon()
λ = lyapunov(henon, 10000, d0 = 1e-7, upper_threshold = 1e-4, Ttr = 100)</code></pre><pre><code class="language-none">0.42018736282059616</code></pre><p>The same is done for continuous systems:</p><pre><code class="language-julia">lor = Systems.lorenz(ρ = 32)
λ = lyapunov(lor, 10000.0, dt = 10.0, Ttr = 100.0)</code></pre><pre><code class="language-none">0.992726492114718</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Lyapunov1992"><a class="tag is-link" href="#citeref-Lyapunov1992">Lyapunov1992</a>A. M. Lyapunov, <em>The General Problem of the Stability of Motion</em>, Taylor &amp; Francis (1992)</li><li class="footnote" id="footnote-Geist1990"><a class="tag is-link" href="#citeref-Geist1990">Geist1990</a>K. Geist <em>et al.</em>, Progr. Theor. Phys. <strong>83</strong>, pp 875 (1990)</li><li class="footnote" id="footnote-Benettin1980"><a class="tag is-link" href="#citeref-Benettin1980">Benettin1980</a>G. Benettin <em>et al.</em>, Meccanica <strong>15</strong>, pp 9-20 &amp; 21-30 (1980)</li><li class="footnote" id="footnote-Benettin1976"><a class="tag is-link" href="#citeref-Benettin1976">Benettin1976</a>G. Benettin <em>et al.</em>, Phys. Rev. A <strong>14</strong>, pp 2338 (1976)</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../orbitdiagram/">« Orbit Diagrams &amp; PSOS</a><a class="docs-footer-nextpage" href="../chaos_detection/">Detecting &amp; Categorizing Chaos »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 16 November 2020 00:41">Monday 16 November 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
